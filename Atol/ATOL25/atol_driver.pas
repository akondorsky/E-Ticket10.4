unit ATOL.Driver;

interface

uses Windows, Classes, SysUtils, ComObj, ActiveX, Variants;

const
  // –егистры   ћ
  // „исловые константы
  kvKKMNumber = 0;
  kvPaymentType1_KREDIT_Enabled = 2;
  kvPaymentType2_TARA_Enabled = 3;
  kvPaymentType3_PAYCARD_Enabled = 41;
  kvPrintSectionName = 39;
  kvSlipDocsEnabled = 40;
  kvPrintReclama = 45;
  kvAutoOpenDrawer = 46;
  kvPrintKassirNames = 56;
  kvClisheLinesCount = 66;
  kvPrintSectionNumbers = 72;
  kvPrintOpenSessionDoc = 73;
  kvQuantityPrintType = 80;
  kvWinterTimeType = 82;
  kvHeaderPrintType = 196;
  kvCheckPrintType = 198;
  kvExtendedZXReports = 207;
  kvCheckLiftValue = 233;

  // —троковые константы
  ksSeparatorChar = 201;
  ksHeaderStr1 = 0;
  ksHeaderStr2 = 1;
  ksHeaderStr3 = 2;
  ksHeaderStr4 = 3;
  ksHeaderStr5 = 4;
  ksHeaderStr6 = 5;

  ksClisheStr1 = 69;
  ksClisheStr2 = 70;
  ksClisheStr3 = 71;
  ksClisheStr4 = 72;
  ksClisheStr5 = 73;
  ksClisheStr6 = 74;
  ksClisheStr7 = 75;
  ksClisheStr8 = 76;
  ksClisheStr9 = 77;
  ksClisheStr10 = 78;
  ksClisheStr11 = 79;
  ksClisheStr12 = 80;
  ksClisheStr13 = 81;
  ksClisheStr14 = 82;
  ksClisheStr15 = 83;
  ksClisheStr16 = 84;
  ksClisheStr17 = 85;
  ksClisheStr18 = 86;
  ksClisheStr19 = 87;
  ksClisheStr20 = 88;

  ksPaymentType1Name = 66;
  ksPaymentType2Name = 67;
  ksPaymentType3Name = 68;

type
  TUnitCodePage = (ucpRU = 0, ucpARM = 1, ucpMOL = 2, ucpUA = 3, ucpLIT = 4,
    ucpTURKM = 5, ucpMON = 6, ucpBEL = 7, ucpLATV = 8, ucpGEOR = 9, ucpKAZ = 10,
    ucpEST = 11, ucpAZER = 12, ucpKIRG = 13, ucpTAG = 14, ucpUZ = 15,
    ucpPOL = 16, ucpROM = 17, ucpBOLG = 18, ucpENG = 19);

  TUnitType = (utCPU = 1, utFM = 2, utBoot = 3, utPrnSoft);
  // 1 Ц ѕќ основного процессора   ћ;
  // 2 Ц ѕќ процессора фискального модул€   ћ;
  // 3 Ц ѕќ загрузочного блока основного процессора   ћ;
  // 4 Ц ѕќ принтера

  // »нформаци€ о модуле
  TUnitInfo = record
    UnitType: TUnitType;
    UmajorVersion: integer;
    UminorVersion: integer;
    Ubuild: integer;
    UcodePage: TUnitCodePage;
  end;

  // —троковые параметры 69..88
  // TFRClisheFooter = TArray<String>;

  // Ќаименование видов оплат
  // —троки 66..68 параметров

  TDeviceType = (dtNotDefined = 0, dtKKM = 1, dtScales = 2, dtMemoPlus = 3);
  // “ип оборудовани€:
  // 0 Ц не определен;
  // 1 Ц   ћ;
  // 2 Ц весы электронные;
  // 3 Ц Memo PlusЩ;

  TTextWrapMode = (wNotWrap = 0, wByWords = 1, wByStrings = 2);

  TDeviceMode = (dmOffLine = 32768, dmOnline = 16384, dmPassiveOnline = 8192,
    dmFR = 4096, dmFP = 2048);
  // ѕоддерживаемые оборудованием режимы:
  // 32768 Ц режим OffLine;
  // 16384 Ц режим OnLine;
  // 8192 Ц пассивный OnLine (принтер чеков);
  // 4096 Ц фискальный регистратор;
  // 2048 Ц фискальна€ плата

  // ѕараметры устройства
  TDeviceMetrics = record
    UprotocolVersion: integer;
    Utype: TDeviceType;
    Umodel: integer;
    Umode: TDeviceMode;
    UmajorVersion: integer;
    UminorVersion: integer;
    Ubuild: integer;
    UcodePage: TUnitCodePage;
    Udescription: string;
  end;

  TKKMFont = record
    Italic: boolean;
    Bold: boolean;
    Negative: boolean; // ‘он символов RW
    Underline: boolean; // ѕодчеркнутый шрифт RW
    DblHeight: boolean; // Ўрифт двойной высоты RW
    DblWidth: boolean; // Ўрифт двойной толщины RW
  end;

  TKKMReportType = (rtKLGash = 0, rtZReport = 1, rtXReport = 2,
    rtFPDateRange = 3, rtFPSessRange = 4, rtFPDateRangeFull = 5,
    rtFPSessRangeFull = 6, rtSections = 7, rtKassir = 8, rtGoods = 9,
    rtHours = 10, rtQuantity = 11, rtEKLZActItogs = 22, rtEKLZSessItogs = 23,
    rtEKLZSessionKL = 24, rtEKLZKPK = 25, rtEKLZDatesShortByOtdel = 26,
    rtEKLZDatesFullByOtdel = 27);
  // 0 √ашение контрольной ленты
  // 1  —уточный отчет с гашением
  // 2  —уточный отчет без гашени€
  // 3   раткий фискальный отчет по диапазону дат.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 4   раткий фискальный отчет по диапазону смен.
  // ¬ходные свойства Ц Session, EndSession
  // 5  ѕолный фискальный отчет по диапазону дат.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 6  ѕолный фискальный отчет по диапазону смен.
  // ¬ходные свойства Ц Session, EndSession
  // 7  ќтчет по секци€м
  // 8  ќтчет по кассирам
  // 9  ќтчет по товарам
  // 10 ќтчет по часам
  // 11 ќтчет по количеству
  // 22 Ё Ћ« итоги активизации
  // 23 Ё Ћ« итоги смены.
  // ¬ходные свойства Ц Session
  // 24 Ё Ћ« контрольна€ лента смены.
  // ¬ходные свойства Ц Session
  // 25 Ё Ћ« документ по номеру  ѕ .
  // ¬ходные свойства Ц EKLZKPKNumber
  // 26 Ё Ћ« по датам краткий по отделам.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 27 Ё Ћ« по датам полный по отделам.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 28 Ё Ћ« по датам краткий по итогам смен.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 29 Ё Ћ« по датам полный по итогам смен.
  // ¬ходные свойства Ц Day, Month, Year, EndDay, EndMonth, EndYear
  // 30 Ё Ћ« по сменам краткий по отделам.
  // ¬ходные свойства Ц Session, EndSession
  // 31 Ё Ћ« по сменам полный по отделам.
  // ¬ходные свойства Ц Session, EndSession
  // 32 Ё Ћ« по сменам краткий по итогам смен.
  // ¬ходные свойства Ц Session, EndSession
  // 33 Ё Ћ« по сменам полный по итогам смен.
  // ¬ходные свойства Ц Session, EndSession
  // 34 ѕечать документа из Ё∆ по номеру.
  // ¬ходные свойства Ц DocNumber
  // 35 ѕечать Ё∆ (полна€  Ћ).
  // ¬ходные свойства Ц ClearJrn
  // 36 ѕечать Ё∆ (кратка€  Ћ).
  // ¬ходные свойства Ц ClearJrn
  // 37 ѕечать сохранЄнных отчЄтов с гашением
  // 38 —лужебный отчет
  // 39 ѕечать отчета из SD-карты
  // 40 ¬едомость общих показаний

  TCheckType = (ctSale = 1, ctReturn = 2, ctAnnulate = 3, ctBuy = 4,
    ctBuyReturn = 5, ctBuyAnnulate = 6);
  // “ип чека:
  // 1 Ц продажа;
  // 2 Ц возврат продажи;
  // 3 Ц аннулирование продажи;
  // 4 Ц покупка;
  // 5 Ц возврат покупки;
  // 6 Ц аннулирование покупки

  TTypeClose = (tcCash = 0, tcType1 = 1, tcType2 = 2, tcType3 = 3, tcType4 = 4,
    tcType5 = 5);
  // ¬иды оплаты
  // 0 - Ќаличными, 1 - ¬ид оплаты 1..

  // –ежимы работы   ћ
  TKKMMode = (kmSelect = 0, kmRegistration = 1, kmXReport = 2, kmZReport = 3,
    kmProgram = 4);

  TKKMCheckState = (csClosed = 0, csSaleOpened = 1, csSaleReturnOpened = 2,
    csSaleAnnulateOpened = 3, csBuyOpened = 4, csBuyReturnOpened = 5);
  // 0 Ц закрыт;
  // 1 Ц открыт чек продажи;
  // 2 Ц открыт чек возврата продажи;
  // 3 Ц открыт чек аннулировани€ продажи;
  // 4 Ц открыт чек покупки;
  // 5 Ц открыт чек возврата покупки

  TKKMDriver = class
  protected
    FDevice: Variant; // объект драйвера
  private
    FReportType: TKKMReportType;

    function GetInboundStream: string;
    procedure SetInboundStream(const Value: string);
    function GetDisablePasswordSettings: boolean;
    procedure SetAccessPassword(const Value: string);
    procedure SetAdvancedMode(const Value: integer);
    procedure SetAdvancedRegistration(const Value: boolean);
    procedure SetAlignment(const Value: integer);
    procedure SetApplicationHandle(const Value: THandle);
    procedure SetAutoSize(const Value: boolean);
    procedure SetBarcode(const Value: string);
    procedure SetBarcodeControlCode(const Value: boolean);
    procedure SetBarcodeType(const Value: integer);
    procedure SetBaudRate(const Value: integer);
    procedure SetBufferingMode(const Value: boolean);
    procedure SetCheckNumber(const Value: integer);
    procedure SetCheckType(const Value: TCheckType);
    procedure SetCount(const Value: integer);
    procedure SetCounterType(const Value: integer);
    procedure SetCurrentDeviceIndex(const Value: integer);
    procedure SetCurrentDeviceName(const Value: string);
    procedure SetCurrentDeviceNumber(const Value: integer);
    procedure SetDay(const Value: word);
    procedure SetDefaultPassword(const Value: string);
    procedure SetDepartment(const Value: integer);
    procedure SetDestination(const Value: integer);
    procedure SetDeviceEnabled(const Value: boolean);
    procedure SetDeviceSettings(const Value: string);
    procedure SetDevicesSettings(const Value: string);
    procedure SetDiscountType(const Value: integer);
    procedure SetDiscountTypeNumber(const Value: integer);
    procedure SetDiscountValue(const Value: Double);
    procedure SetDrawerOffTimeout(const Value: integer);
    procedure SetDrawerOnQuantity(const Value: integer);
    procedure SetDrawerOnTimeout(const Value: integer);
    procedure SetDuration(const Value: integer);
    procedure SetEnableCheckSumm(const Value: boolean);
    procedure SetEndDay(const Value: word);
    procedure SetEndMonth(const Value: word);
    procedure SetEndSession(const Value: integer);
    procedure SetEndYear(const Value: word);
    procedure SetEntryNum(const Value: integer);
    procedure SetFileName(const Value: string);
    procedure SetFontBold(const Value: boolean);
    procedure SetFontDblHeight(const Value: boolean);
    procedure SetFontDblWidth(const Value: boolean);
    procedure SetFontItalic(const Value: boolean);
    procedure SetFontNegative(const Value: boolean);
    procedure SetFontUnderline(const Value: boolean);
    procedure SetFrequency(const Value: integer);
    procedure SetHeight(const Value: integer);
    procedure SetHour(const Value: word);
    procedure SetJrnBrightness(const Value: integer);
    procedure SetJrnFont(const Value: integer);
    procedure SetJrnFontHeight(const Value: integer);
    procedure SetJrnLineSpacing(const Value: integer);
    procedure SetLineNumber(const Value: integer);
    procedure SetMachineName(const Value: string);
    procedure SetMachineNumber(const Value: string);
    procedure SetMinute(const Value: word);
    procedure SetModel(const Value: integer);
    procedure SetModelCheck(const Value: boolean);
    procedure SetMonth(const Value: word);
    procedure Setname(const Value: string);
    procedure SetOperationType(const Value: integer);
    procedure SetOperatorNo(const Value: integer);
    procedure SetOutBoundStream(const Value: string);
    procedure SetPercents(const Value: Double);
    procedure SetPictureNumber(const Value: integer);
    procedure SetPortNumber(const Value: integer);
    procedure SetPrice(const Value: Double);
    procedure SetPrintBarcodeText(const Value: integer);
    procedure SetPrintPurpose(const Value: integer);
    procedure SetQuantity(const Value: Double);
    procedure SetRecBrightness(const Value: integer);
    procedure SetRecFont(const Value: integer);
    procedure SetRecFontHeight(const Value: integer);
    procedure SetRecLineSpacing(const Value: integer);
    procedure SetRegisterNumber(const Value: integer);
    procedure SetScale(const Value: Double);
    procedure SetScaleVB(const Value: Double);
    procedure SetSecond(const Value: word);
    procedure SetSlipDocCopyCountHorz(const Value: integer);
    procedure SetSlipDocCopyCountVert(const Value: integer);
    procedure SetSlipDocCopyShiftHorz(const Value: integer);
    procedure SetSlipDocCopyShiftVert(const Value: integer);
    procedure SetSlipDocLeftMargin(const Value: integer);
    procedure SetSlipDocOrientation(const Value: integer);
    procedure SetSlipDocTopMargin(const Value: integer);
    procedure SetSlotNumber(const Value: integer);
    procedure SetStreamFormat(const Value: integer);
    procedure SetKKMSumm(const Value: Double);
    function GetKKMSumm: Double;
    procedure SetTaxTypeNumber(const Value: integer);
    // procedure SetTestMode(const Value: boolean);
    procedure SetTextWrap(const Value: integer);
    procedure SetTypeClose(const Value: TTypeClose);
    procedure SetUmode(const Value: TDeviceMode);
    procedure SetUmodel(const Value: integer);
    procedure SetUseAccessPassword(const Value: boolean);
    procedure SetWidth(const Value: integer);
    procedure SetWriteLogFile(const Value: word);
    procedure SetYear(const Value: word);
    procedure SetDisableParamWindow(const Value: boolean);
    procedure SetDisablePasswordSettings(const Value: boolean);
    procedure SetLockDevices(const Value: boolean);
    procedure SetShowProgress(const Value: boolean);
    procedure SetKKMMode(Value: TKKMMode);
    function GetKKMMode: TKKMMode;
    function GetAccessPassword: string;
    function GetAdvancedMode: integer;
    function GetAdvancedRegistration: boolean;
    function GetAlignment: integer;
    function GetApplicationHandle: THandle;
    function GetAutoSize: boolean;
    function GetBadParam: integer;
    function GetBadParamDescription: string;
    function GetBarcode: string;
    function GetBarcodeType: integer;
    function GetBatteryLow: boolean;
    function GetBaudRate: integer;
    function GetBufferingMode: boolean;
    function GetChange: Double;
    function GetCharLineLength: integer;
    function GetCheckNumber: integer;
    function GetCheckPaperPresent: boolean;
    function GetCheckState: TKKMCheckState;
    function GetCheckType: TCheckType;
    function GetControlPaperPresent: boolean;
    function GetCount: integer;
    function GetCounterType: integer;
    function GetCoverOpened: boolean;
    function GetCurrentDeviceIndex: integer;
    function GetCurrentDeviceName: string;
    function GetCurrentDeviceNumber: integer;
    function GetDay: word;
    function GetDefaultPassword: string;
    function GetDepartment: integer;
    function GetDestination: integer;
    function GetDeviceCount: integer;
    function GetDeviceDescription: string;
    function GetDeviceEnabled: boolean;
    function GetDeviceSettings: string;
    function GetDevicesSettings: string;
    function GetDisableParamWindow: boolean;
    function GetDiscountType: integer;
    function GetDiscountTypeNumber: integer;
    function GetDiscountValue: Double;
    function GetDocNumber: integer;
    function GetDrawerOffTimeout: integer;
    function GetDrawerOnQuantity: integer;
    function GetDrawerOnTimeout: integer;
    function GetDrawerOpened: boolean;
    function GetDuration: integer;
    function GetECRError: integer;
    function GetECRErrorDescription: string;
    function GetEnableCheckSumm: boolean;
    function GetEndDay: word;
    function GetEndMonth: word;
    function GetEndSession: integer;
    function GetEndYear: word;
    function GetEntryNum: integer;
    function GetBarcodeControlCode: boolean;
    function GetFileName: string;
    function GetFiscal: boolean;
    function GetFontBold: boolean;
    function GetFontDblHeight: boolean;
    function GetFontDblWidth: boolean;
    function GetFontItalic: boolean;
    function GetFontNegative: boolean;
    function GetFontUnderline: boolean;
    function GetFrequency: integer;
    function GetHeight: integer;
    function GetHour: word;
    function GetINN: string;
    function GetIsDemo: boolean;
    function GetJrnBrightness: integer;
    function GetJrnCharLineLength: integer;
    function GetJrnFont: integer;
    function GetJrnFontHeight: integer;
    function GetJrnLineSpacing: integer;
    function GetJrnPixelLineLength: integer;
    function GetLineNumber: integer;
    function GetLockDevices: boolean;
    function GetMachineName: string;
    function GetMachineNumber: string;
    function GetMinute: word;
    function GetModel: integer;
    function GetModelCheck: boolean;
    function GetMonth: word;
    function GetName: string;
    function GetOperationType: integer;
    function GetOperatorNo: integer;
    function GetOutBoundStream: string;
    function GetOutOfPaper: boolean;
    function GetPasswordEntered: boolean;
    function GetPercents: Double;
    function GetPictureNumber: integer;
    function GetPictureState: integer;
    function GetPixelLineLength: integer;
    function GetKKMPointPosition: word;
    procedure SetKKMPointPosition(Value: word);
    function GetPortNumber: integer;
    function GetPrice: Double;
    function GetPrintBarcodeText: integer;
    function GetPrinterConnectionFailed: boolean;
    function GetPrinterCutMechanismError: boolean;
    function GetPrinterMechanismError: boolean;
    function GetPrinterOverheatError: boolean;
    function GetPrintPurpose: integer;
    function GetQuantity: Double;
    function GetRcpCharLineLength: integer;
    function GetRcpPixelLineLength: integer;
    function GetRecBrightness: integer;
    function GetRecFont: integer;
    function GetRecFontHeight: integer;
    function GetRecLineSpacing: integer;
    function GetRegisterNumber: integer;
    function GetRemainder: Double;
    function GetResultCode: integer;
    function GetResultDescription: string;
    function GetROMVersion: string;
    function GetScale: Double;
    function GetScaleVB: Double;
    function GetSecond: word;
    function GetSerialNumber: string;
    function GetServerVersion: string;
    function GetSession: integer;
    function GetSessionOpened: boolean;
    function GetShowProgress: boolean;
    function GetSlipCharLineLength: integer;
    function GetSlipDocCharLineLength: integer;
    function GetSlipDocCopyCountHorz: integer;
    function GetSlipDocCopyCountVert: integer;
    function GetSlipDocCopyShiftHorz: integer;
    function GetSlipDocCopyShiftVert: integer;
    function GetSlipDocLeftMargin: integer;
    function GetSlipDocOrientation: integer;
    function GetSlipDocTopMargin: integer;
    function GetSlipPixelLineLength: integer;
    function GetSlotNumber: integer;
    function GetStreamFormat: integer;
    function GetTaxTypeNumber: integer;
    // function GetTestMode: boolean;
    function GetTextWrap: integer;
    function GetTypeClose: TTypeClose;
    function GetUmode: TDeviceMode;
    function GetUmodel: integer;
    function GetUseAccessPassword: boolean;
    function GetVersion: string;
    function GetWidth: integer;
    function GetWriteLogFile: word;
    function GetYear: word;
    procedure SetSession(const Value: integer);
    function GetKKMPassword: string;
    procedure SetKKMPassword(Value: string);
    function GetKKMCaption: string;
    procedure SetKKMCaption(Value: string);
    procedure SetKKMValue(Value: integer);
    function GetKKMValue: integer;
    procedure SetReportType(const Value: TKKMReportType);
    function GetReportType: TKKMReportType;
    function GetKKMValuePurpose: integer;
    procedure SetKKMValuePurpose(const Value: integer);
    function GetKKMCaptionPurpose: integer;
    procedure SetKKMCaptionPurpose(const Value: integer);
    function GetOperatorName: string;
    function GetOperatorPassword: string;
    procedure SetOperatorName(const Value: string);
    procedure SetOperatorPassword(const Value: string);
    function GetDeviceEnableTimeout: integer;
    procedure SetDeviceEnableTimeout(const Value: integer);
    function GetBarcodeColumns: integer;
    function GetBarcodeOptions: integer;
    function GetBarcodeRows: integer;
    function GetCorrectionLevel: integer;
    procedure SetBarcodeColumns(const Value: integer);
    procedure SetBarcodeOptions(const Value: integer);
    procedure SetBarcodeRows(const Value: integer);
    procedure SetCorrectionLevel(const Value: integer);
    function GetTransactionType: integer;
    procedure SetTransactionType(const Value: integer);
    function GetMaxCaptionLength: integer;
    procedure SetMaxCaptionLength(const Value: integer);
    function GetFRLicense: integer;
    procedure SetFRLicense(const Value: integer);
    function GetEKLZFlags: integer;
    procedure SetEKLZFlags(const Value: integer);
    procedure SetAttrNumber(const Value: integer);
    procedure SetAttrValue(const Value: string);
    function GetAttrNumber: integer;
    function GetAttrValue: string;
  public
    constructor Create;
    destructor Destroy;
    function ShowProperties(): integer; // ѕоказать —траницу —войств
    function SetMode(): integer; // ”становить режим
    function ResetMode(): integer; // ¬ыход из режима
    function LockKeyboard(): integer;
    function UnLockKeyboard(): integer;
    function Beep(): integer;
    function Sound(): integer; // Ќужно задать Duration и Frequency
    function DisplayDraw: integer;
    // Ќужно задать Caption. ¬ывод информации (посегментно) на дисплей   ћ
    function AdvancedDisplayWrite(): integer;
    // ¬ыводит на дисплей   ћ произвольную информацию
    function RunCommand(): integer;
    function OpenDrawer(): integer; // ќткрыть денежный €щик
    function AdvancedOpenDrawer(): integer;
    // импульсное открытие денежного €щика
    function FullCut(): integer;
    function PartialCut(): integer;
    function GetStatus(): integer;
    function GetLastError(): integer;
    function GetCurrentMode(): integer;
    function GetRegister(): integer;
    function GetSumm(): integer; // Ќаличные в ƒя. PointPosition вх / Summ вых
    function GetUnitVersion(): integer; // ѕолучить версию
    function GetDeviceMetrics(): integer;
    function GetSupportedMode(): integer;
    function GetRange(): integer; // ѕолучить диапазоны фискальных отчетов
    function GetLastSummary(): integer;
    // ѕри выполнении метода в свойство Summ записываетс€ сменный итог.
    function OpenSession(): integer;
    // ћетод открывает смену на   ћ (in TestMode, Caption)
    function CashIncome(): integer;
    // ћетод регистрирует внесение наличных денег в кассу (in TestMode, Summ)
    function CashOutcome(): integer;
    // ћетод регистрирует выплату наличных денег из кассы (in TestMode, Summ)
    function Report(): integer; // ReportType: 0 Е 11 и 22 Е 37,
    function NewDocument(): integer;
    // ƒанные метод €вл€етс€ сервисным и представл€ет собой логическое
    // сочетание нескольких кассовых операций (GetStatus(), SetMode(), CancelCheck() и т.д.).
    function OpenCheck(): integer;
    // ћетод открывает чек соответствующего типа (свойство CheckType)
    function Registration(): integer; // ћетод производит регистрацию продажи
    function Annulate(): integer; // јннулирование продажи
    function Return(): integer;
    // ћетод производит регистрацию возврата продажи
    function Buy(): integer; // ћетод производит регистрацию покупки
    function BuyReturn(): integer;
    // ћетод производит регистрацию возврата покупки
    function BuyAnnulate(): integer;
    // ћетод производит регистрацию аннулирование покупки
    function Storno(): integer; // ћетод производит сторнирование регистрации
    // (продажи, возврата продажи, аннулировани€ продажи, покупки, возврата покупки)
    function PercentsCharge(): integer;
    // ћетод производит регистрацию процентной надбавки на весь чек или последнюю операцию
    function PercentsDiscount(): integer;
    // ћетод производит регистрацию процентной скидки на весь чек или последнюю операцию
    function SummCharge(): integer;
    // ћетод производит регистрацию надбавки суммой на весь чек или последнюю операцию
    function SummDiscount(): integer;
    // ћетод производит регистрацию скидки суммой на весь чек или последнюю операцию
    function ResetChargeDiscount(): integer;
    // ћетод отмен€ет последнюю проведенную операцию начислени€ скидки или надбавки любого типа
    function Payment(): integer;
    // ћетод производит регистрацию платежа по чеку заданным
    // типом оплаты с подсчетом суммы сдачи и неоплаченного остатка чека
    function StornoPayment(): integer;
    // —торнирование платежа на сумму, заданным типом оплаты
    function CancelCheck(): integer;
    // ћетод производит аннулирование (отмену) всего чека.
    // ѕри этом на чеке печатаетс€ Ђ„≈  јЌЌ”Ћ»–ќ¬јЌї
    function CloseCheck(): integer; // «акрытие чека без подсчета суммы сдачи

    function GetLicense(): integer;
    function SetLicense(): integer;

    function Delivery(): integer;
    // «акрытие чека продажи с оплатой наличными и подсчетом суммы сдачи
    function SummTax(): integer;
    // –егистраци€ налога, предварительно настроенного в   ћ
    function ResetTax(): integer; // ќтмена налога указанного типа
    function PrintString(): integer;
    // ћетод служит дл€ печати строки символов
    // на чековой ленте и/или контрольной ленте

    function WriteAttribute: integer;

    function PowerOff(): integer;
    // ѕрограммное выключение   ћ
    function AddField(): integer; // ћетод служит дл€ формировани€ строки
    // текста во внутреннем буфере драйвера с использованием различного
    // формата написани€ символов, дл€ последующей печати на   ћ при помощи метода PrintField
    function PrintField(): integer;
    // ѕри вызове метода на чековой и/или контрольной,
    // в зависимости от значени€ свойства PrintPurpose, ленте будет напечатан текст, заданный в свойстве Caption
    function PrintHeader(): integer;
    // ћетод печатает на чеке клише, запрограммированное в   ћ
    function PrintFooter(): integer;
    // ћетод печатает на чеке блок атрибутов чека, идентичный тому, который печатаетс€ в отчетах без гашени€
    function BeginDocument(): integer;
    // ѕечать нефискального документа на принтере ѕƒ.
    // ћетод переводит драйвер в состо€ние буферизации данных, добавл€емых методами печати строки и пол€
    function EndDocument(): integer; // ѕечать на принтере ѕƒ.
    // ћетод передает данные из внутреннего буфера драйвера на печать в   ћ, освобождает выделенную дл€ внутреннего буфера пам€ть и выводит драйвер из состо€ни€ буферизации записей
    function BeginFiscDocument(): integer;
    // ѕодкладной документ при печати на   ћ состоит из оригинала с фискальным признаком и его копий
    function EndFiscDocument(): integer;
    // ƒл€   ћ ‘≈Ћ» —-3—  метод выводит драйвер из режима печати подкладных документов.
    // ƒл€   ћ ѕ–»ћ-07  метод выводит на печать подкладной документ с фискальным признаком и несколько его копий.
    function PrintBarcode(): integer;
    // ћетод печатает штрихкод, задаваемоый в свойствах Barcode и BarcodeType,
    // с отступом от левого кра€, равным LeftMargin и выравниванием, указанным в свойстве Alignment.
    // –азмеры печатаемого штрихкода задаютс€ свойствами Height (в элементарных строках),
    // Scale (в процентах от реального размера) и AutoSize
    function PrintBitmap(): integer;
    // ѕри выполнении метод печатает битовую строки. ‘ормат битовой строки указываетс€ в свойстве StreamFormat, а ее значение в свойстве OutboundStream. –астр будет печататьс€ с отступом от левого кра€, равным LeftMargin и выравниванием, указанным в свойстве Alignment.
    // –азмеры печатаемой битовой строки задаютс€ свойствами Scale (в процентах от реального размера) и AutoSize.
    // ѕринтер (чековой / контрольной ленты), на котором нужно напечатать, задаетс€ свойством PrintPurpose
    function PrintBitmapFromFile(): integer;
    // ѕри выполнении метод печатает картинку из указываемого файла с заданным отступом
    function GetStatusPictureArray(): integer;
    // ѕри выполнении метод получает состо€ние массива картинок в пам€ти   ћ. ѕри этом определ€ютс€ Ц количество свободных байт в массиве (свойство Count), количество картинок
    // в массиве (PictureNumber) и состо€ние последней добавленной картинки в массиве (открыта / закрыта) Ц свойство PictureState
    function GetStatusPicture(): integer;
    // ћетод по номеру картинки в пам€ти   ћ запрашивает параметры этой картинки: состо€ние картинки, ее ширину и высоту
    function PrintPicture(): integer;
    // ћетод печатает картинку по номеру PictureNumber, записанную в пам€ть   ћ, с заданным выравниванием и отступом от левого кра€
    function ClearOutput(): integer;
    // ћетод освобождает выделенную дл€ внутреннего буфера пам€ть и выводит драйвер из состо€ни€ буферизации записей, не передава€ данных из внутреннего буфера драйвера в   ћ.
    // »спользование метода позвол€ет Ђотменитьї начатое методами BeginAdd и BeginDocument добавление данных в   ћ.
    { ѕрограммирование   ћ }
    function SetPassword(): integer;
    // ћетод устанавливает пароль доступа к   ћ. ѕароль доступа к   ћ задаетс€ свойством Password.
    // ѕосле успешного выполнени€ метода значение свойства AccessPassword мен€етс€ на установленное
    function GetPassword(): integer;
    // ћетод записывает в свойство Password пароль доступа к   ћ из таблицы настроек   ћ
    function SetCaption(): integer; // —троковые параметры   ћ (приложение 9)
    // ћетод используетс€ дл€ программировани€ текстовых системных параметров   ћ. ѕрограммируемое значение задаетс€ в свойстве Caption, номер параметра Ц в свойстве CaptionPurpose,
    // максимально возможна€ длина строки Ц в свойстве MaxCaptionLength (даже в случае, если при выполнении метода произошла ошибка)
    function GetCaption(): integer;
    // ћетод используетс€ дл€ получени€ значений текстовых системных параметров   ћ, номер параметра задаетс€ в свойстве CaptionPurpose.
    function SetValue(): integer; // „исловые параметры   ћ (приложение 10)
    // ћетод используетс€ дл€ программировани€ числовых (не строковых) системных настроек   ћ. «начение задаетс€ в свойстве Value, номер настройки Ц в свойстве ValuePurpose
    function GetValue(): integer;
    // ћетод используетс€ дл€ получени€ значений числовых (не строковых) системных настроек   ћ. Ќомер настройки задаетс€ в свойстве ValuePurpose.
    // ¬ случае успешного завершени€ метода значение настройки сохран€етс€ в свойстве Value
    function SetSettings(): integer;
    // ћетод используетс€ дл€ записи данных в указанную €чейку любой системной таблицы   ћ.
    // —труктура таблиц описана в руководстве оператора и в протоколе работы   ћ, вход€щими в комплект поставки   ћ
    function GetSettings(): integer;
    // ћетод используетс€ дл€ получени€ содержимого указанной €чейки из любой системной таблицы   ћ.
    // —труктура таблиц описана в руководстве оператора и в протоколе работы   ћ, вход€щими в комплект поставки   ћ
    function SetDate(): integer;
    // ћетод устанавливает системную дату в   ћ. ≈сли вводима€ дата больше, чем на один день, текущей даты,
    // то   ћ требует подтверждени€ ввода даты Ц необходимо второй раз вызвать метод.
    function SetTime(): integer; // ћетод устанавливает системное врем€ в   ћ
    function SetPointPosition(): integer;
    // ћетод устанавливает положение дес€тичной точки в   ћ. Ќовое положение точки (количество разр€дов после (справа от) дес€тичной точки) задаетс€ в свойстве PointPosition.
    // ¬ыполнение метода допустимо только после проведени€ общего гашени€   ћ
    function DeviceEnableEx(): integer;
    // ћетод позвол€ет организовать очередь печати на   ћ.
    // ѕоведение драйвера при вызове метода регулируетс€ единственным свойством DeviceEnableTimeout.

    function EKLZGetStatus: integer;

  published
    // «начение регистра чисел RW
    property ValuePurpose: integer read GetKKMValuePurpose
      write SetKKMValuePurpose;

    // «начение регистра строк RW
    property CaptionPurpose: integer read GetKKMCaptionPurpose
      write SetKKMCaptionPurpose;

    property EKLZFlags: integer read GetEKLZFlags write SetEKLZFlags;
    // Ц0 Ц 1
    // 0 Ц продажа
    // 2 Ц возврат продажи

    // 2
    // 0 Ц архив закрыт
    // 1 Ц архив открыт

    // 3
    // 0 Ц Ё Ћ« не активизировано
    // 1 Ц Ё Ћ« активизировано

    // 4
    // 0 Ц нет отчета
    // 1 Ц отчет снимаетс€

    // 5
    // 0 Ц документ закрыт
    // 1 Ц документ открыт

    // 6
    // 0 Ц смена закрыта
    // 1 Ц смена открыта

    // 7
    // 0 Ц нет неисправимой ошибки устройства
    // 1 Ц есть неисправима€ ошибка устройства

    // ќкно свойств драйвера
    property DisablePasswordSettings: boolean read GetDisablePasswordSettings
      write SetDisablePasswordSettings; // «апрет»зменени€ѕарол€ RW
    property LockDevices: boolean read GetLockDevices write SetLockDevices;
    // Ѕлокировать”стройства RW
    property DisableParamWindow: boolean read GetDisableParamWindow
      write SetDisableParamWindow; // «апретќкнаѕараметров RW

    property ShowProgress: boolean read GetShowProgress write SetShowProgress;
    // ѕризнак показа прогресса RW
    property Mode: TKKMMode read GetKKMMode write SetKKMMode;
    // режим работы RW
    property Password: string read GetKKMPassword write SetKKMPassword;
    // ѕароль входа в режим RW
    property Barcode: string read GetBarcode write SetBarcode;
    // —имвольный эквивалент штрихкода RW

    property License: integer read GetFRLicense write SetFRLicense;
    // Ќомер лицензии

    property ReportType: TKKMReportType read FReportType write SetReportType;
    // ƒл€ метода AddField
    property FontBold: boolean read GetFontBold write SetFontBold;
    // Ўрифт двойной толщины RW
    property FontItalic: boolean read GetFontItalic write SetFontItalic;
    // Ўрифт курсивом RW
    property FontNegative: boolean read GetFontNegative write SetFontNegative;
    // ‘он символов RW
    property FontUnderline: boolean read GetFontUnderline
      write SetFontUnderline; // ѕодчеркнутый шрифт RW
    property FontDblHeight: boolean read GetFontDblHeight
      write SetFontDblHeight; // Ўрифт двойной высоты RW
    property FontDblWidth: boolean read GetFontDblWidth write SetFontDblWidth;
    // Ўрифт двойной ширины RW

    property MaxCaptionLength: integer read GetMaxCaptionLength
      write SetMaxCaptionLength;

    property PrintPurpose: integer read GetPrintPurpose write SetPrintPurpose;
    // Ќазначение печати: RW
    // 1 Ц печать на „Ћ;
    // 2 Ц печать на  Ћ;
    // 3 Ц печать на „Ћ и  Ћ

    property PictureState: integer read GetPictureState;
    // —осто€ние последней картинки в пам€ти   ћ: R
    // 0 Ц закрыта;
    // 1 Ц открыта

    // Ќомер атрибута
    property AttrNumber: integer read GetAttrNumber write SetAttrNumber;
    property AttrValue: string read GetAttrValue write SetAttrValue;

    property PictureNumber: integer read GetPictureNumber
      write SetPictureNumber;
    //  оличество картинок в пам€ти   ћ: 1 ... 255 RW

    property FileName: string read GetFileName write SetFileName;
    // »м€ файла картинки RW

    property Width: integer read GetWidth write SetWidth;
    // Ўирина картинки: 1 ... 65535 RW
    property Height: integer read GetHeight write SetHeight;
    // ¬ысота изображени€: 1 Е 65535 RW
    property PrintBarcodeText: integer read GetPrintBarcodeText
      write SetPrintBarcodeText;
    // ѕечатать символьный эквивалент штрихкода:
    // 0 Ц не печатать;
    // 1 Ц печатать над Ў ;
    // 2 Ц печатать под Ў ;
    // 3 Ц печатать над/под Ў 

    property BarcodeControlCode: boolean read GetBarcodeControlCode
      write SetBarcodeControlCode;
    // ѕризнак использовани€ контрольного символа RW

    property BarcodeType: integer read GetBarcodeType write SetBarcodeType;
    // “ип штрихкода: RW
    // 0 Ц UPC-A;
    // 1 Ц CODE39;
    // 2 Ц (E/J)AN13;
    // 3 Ц (E/J)AN8;
    // 4 Ц UPC-E;
    // 5 ЦITF;
    // 6 Ц CODEBAR;
    // 7 ЦCODE93;
    // 8 Ц CODE128;
    // 10 Ц PDF 417;
    // 20 Ц CODE32;
    // 82 Ц EAN 128 CC-A/B;
    // 83 Ц EAN 128 CC-C
    // 84 - QR

    property CorrectionLevel: integer read GetCorrectionLevel
      write SetCorrectionLevel;
    // ”ровень коррекции ошибок Ў 
    property BarcodeOptions: integer read GetBarcodeOptions
      write SetBarcodeOptions;
    // ѕараметры Ў 
    property BarcodeColumns: integer read GetBarcodeColumns
      write SetBarcodeColumns;

    property BarcodeRows: integer read GetBarcodeRows write SetBarcodeRows;

    property Scale: Double read GetScale write SetScale;
    // ћасштаб изображени€ RW
    property ScaleVB: Double read GetScaleVB write SetScaleVB;
    // ћасштаб изображени€ RW
    property AutoSize: boolean read GetAutoSize write SetAutoSize;
    // јвторазмер RW

    property Frequency: integer read GetFrequency write SetFrequency;
    // „астота в √ц 100..2500 RW
    property Duration: integer read GetDuration write SetDuration;
    // ƒлительность мс 10..2550 кратное 10 RW

    property Alignment: integer read GetAlignment write SetAlignment;
    // ¬ыравнивание: 0 Ц по левому краю; 1 Ц по центру; 2 Ц по правому краю RW
    property EntryNum: integer read GetEntryNum write SetEntryNum;
    // Ќомер реквизита RW
    property Caption: string read GetKKMCaption write SetKKMCaption;
    // —трока 24 симв макс RW
    property LineNumber: integer read GetLineNumber write SetLineNumber;
    // Ќомер строки 1..2
    property Percents: Double read GetPercents write SetPercents;
    // ѕроцент надбавки: 0,01 Е 100,00 RW
    property Destination: integer read GetDestination write SetDestination;
    // ќбласть действи€ надбавки: 0 Ц на чек; 1 Ц на позицию RW

    property StreamFormat: integer read GetStreamFormat write SetStreamFormat;
    property OutboundStream: string read GetOutBoundStream
      write SetOutBoundStream;
    // ¬ыходной поток данных
    property InboundStream: string read GetInboundStream write SetInboundStream;
    // ¬ходной поток данных

    property DeviceEnableTimeout: integer read GetDeviceEnableTimeout
      write SetDeviceEnableTimeout;
    // ¬рем€ ожидани€ в очереди (мсек)
    // ≈сли DeviceEnableTimeout=0, то метод включает DeviceEnabled.
    // ≈сли DeviceEnableTimeout>0, то драйвер ожидает указанное врем€. ≈сли по истечении указанного времени   ћ не освободилась, чек распечатан не будет, и драйвер сообщит, что устройство недоступно.
    // ≈сли DeviceEnableTimeout=-1, то драйвер ожидает освобождени€   ћ без ограничени€ времени.

    property Umode:           TDeviceMode read GetUmode write SetUmode;
    property EnableCheckSumm: boolean read GetEnableCheckSumm
      write SetEnableCheckSumm; // ѕровер€ть наличность RW

    property SlipDocCopyCountHorz: integer read GetSlipDocCopyCountHorz
      write SetSlipDocCopyCountHorz;
    //  оличество копий по горизонтали подкладного документа: 0Е9 RW
    property SlipDocCopyCountVert: integer read GetSlipDocCopyCountVert
      write SetSlipDocCopyCountVert;
    //  оличество копий по вертикали подкладного документа: 0Е9 RW
    property SlipDocCopyShiftHorz: integer read GetSlipDocCopyShiftHorz
      write SetSlipDocCopyShiftHorz;
    // —мещение копий по горизонтали подкладного документа: 0Е99 RW
    property SlipDocCopyShiftVert: integer read GetSlipDocCopyShiftVert
      write SetSlipDocCopyShiftVert;
    // —мещение копий по вертикали подкладного документа: 0Е99 RW

    property RegisterNumber: integer read GetRegisterNumber
      write SetRegisterNumber;
    // Ќомер регистра: 1 Е 36 RW   (стр 64-66) RW
    property CheckType: TCheckType read GetCheckType write SetCheckType;
    // “ип чека: RW
    // 1 Ц продажа;
    // 2 Ц возврат продажи;
    // 3 Ц аннулирование продажи;
    // 4 Ц покупка;
    // 5 Ц возврат покупки;
    // 6 Ц аннулирование покупки
    property TypeClose: TTypeClose read GetTypeClose write SetTypeClose;
    // “ип закрыти€ чека: RW
    // 0 - наличными;
    // 1 - тип оплаты 1;
    // 2 - тип оплаты 2;
    // 3 - тип оплаты 3;
    // 4 - тип оплаты 4;
    // 5 - тип оплаты 5
    property OperationType: integer read GetOperationType
      write SetOperationType;
    // “ип операции: 0 Ц продажа; 1 Ц покупка RW
    property CounterType: integer read GetCounterType write SetCounterType;
    // “ип счетчика: 1 Ц несбрасываемый; 2 Ц сбрасываемый RW
    property TaxTypeNumber: integer read GetTaxTypeNumber
      write SetTaxTypeNumber; // Ќомер налоговой ставки: 1 ... 5 RW
    property DiscountTypeNumber: integer read GetDiscountTypeNumber
      write SetDiscountTypeNumber; // Ќомер скидки: 0 ... 16 RW

    property OutOfPaper: boolean read GetOutOfPaper;
    // ѕризнак отсутстви€ бумаги R
    property PrinterConnectionFailed: boolean read GetPrinterConnectionFailed;
    // ѕризнак отсутстви€ св€зи с принтером чеков R
    property PrinterMechanismError: boolean read GetPrinterMechanismError;
    // ѕризнак ошибки печатающего устройства R
    property PrinterCutMechanismError: boolean read GetPrinterCutMechanismError;
    // ќшибка отрезчика R
    property PrinterOverheatError: boolean read GetPrinterOverheatError;
    // ѕерегрев печатающей головки R

    property DrawerOnTimeout: integer read GetDrawerOnTimeout
      write SetDrawerOnTimeout;
    // ¬ключени€ денежного €щика, в 10 мсек: 0 Е 9999 RW
    property DrawerOffTimeout: integer read GetDrawerOffTimeout
      write SetDrawerOffTimeout;
    // ¬ыключени€ денежного €щика, в 10 мсек: 0 Е 9999 RW
    property DrawerOnQuantity: integer read GetDrawerOnQuantity
      write SetDrawerOnQuantity;
    //  оличество импульсов дл€ открыти€ денежного €щика: 0 Е 99 RW
    property OperatorName: string read GetOperatorName write SetOperatorName;
    // »м€ кассира RW
    property OperatorPassword: string read GetOperatorPassword
      write SetOperatorPassword;
    // ѕароль кассира RW
    property OperatorNo: integer read GetOperatorNo write SetOperatorNo;
    // Ќомер кассира RW
    property Fiscal: boolean read GetFiscal;
    // ѕризнак фискализированности   ћ R
    property Hour: word read GetHour write SetHour; // “екущий час RW 0..23 RW
    property Minute: word read GetMinute write SetMinute;
    // “екуща€ минута 1..59 RW
    property Second: word read GetSecond write SetSecond;
    // “екуща€ секунда 1..59 RW
    property Day:   word read GetDay write SetDay; // “екущий день 1..31 RW
    property Month: word read GetMonth write SetMonth;
    // “екущий мес€ц 1..12 RW
    property Year: word read GetYear write SetYear;
    // “екущий год 1998..2089 RW
    property EndDay: word read GetEndDay write SetEndDay;
    // ƒень последней записи ‘ѕ: 1 Е 31 RW
    property EndMonth: word read GetEndMonth write SetEndMonth;
    // ћес€ц последней записи ‘ѕ: 1 Е 12 RW
    property EndYear: word read GetEndYear write SetEndYear;
    // √од последней записи ‘ѕ: 1998 Е 2089 RW
    property EndSession: integer read GetEndSession write SetEndSession;
    // Ќомер смены последней записи ‘ѕ: 0000Е2000 RW

    property SerialNumber: string read GetSerialNumber;
    // —ерийный номер   ћ: строка до 8 символов RW
    property INN: string read GetINN;
    // »дентификационный номер налогоплательщика: 000000000000 Е 999999999999 RW
    property ROMVersion: string read GetROMVersion;
    // ¬ерси€ ѕќ   ћ R
    property AdvancedMode: integer read GetAdvancedMode write SetAdvancedMode;
    // ѕодрежим   ћ RW
    property SlotNumber: integer read GetSlotNumber write SetSlotNumber;
    // Ќомер слота 1..3 RW
    property DrawerOpened: boolean read GetDrawerOpened;
    // ѕризнак открытости денежного €щика R
    property SessionOpened: boolean read GetSessionOpened;
    // ѕризнак открытости смены R
    property CheckPaperPresent: boolean read GetCheckPaperPresent;
    // ѕризнак наличи€ бумаги в принтере чеков R
    property ControlPaperPresent: boolean read GetControlPaperPresent;
    // ѕризнак наличи€ бумаги в принтере контрольной ленты R
    property CoverOpened: boolean read GetCoverOpened;
    // ѕризнак открытости крышки R
    property PasswordEntered: boolean read GetPasswordEntered;
    // ѕризнак Ђвведенностиї парол€ R
    property Umodel: integer read GetUmodel write SetUmodel; // ћодель   ћ RW
    property CheckNumber: integer read GetCheckNumber write SetCheckNumber;
    // Ќомер текущего чека: 0000Е9999 RW
    property Session: integer read GetSession write SetSession;
    // Ќомер смены: 0000Е2000 R
    property CheckState: TKKMCheckState read GetCheckState;
    // “екущее состо€ние чека R
    // 0 Ц закрыт;
    // 1 Ц открыт чек продажи;
    // 2 Ц открыт чек возврата продажи;
    // 3 Ц открыт чек аннулировани€ продажи;
    // 4 Ц открыт чек покупки;
    // 5 Ц открыт чек возврата покупки
    property Summ: Double read GetKKMSumm write SetKKMSumm;
    // —умма чека: 0.00 Е 99999999.99 RW
    property TextWrap: integer read GetTextWrap write SetTextWrap;
    // ѕеренос текста: 0 - нет переноса. 1 - по словам. 2 - по строке RW
    property Count: integer read GetCount write SetCount;
    //  оличество строк: 1 ... 65535 R
    property TransactionType: integer read GetTransactionType
      write SetTransactionType;
    // “ип“ранзакции
    // —войство содержит номер транзакции, характеризующий данные, полученные методом GetRecord.
    // 1
    // ѕродажа по свободной цене
    // Summ Ц сумма продажи;
    // Department Ц секци€, в которую зарегистрирована операци€
    // 2
    // —торно по свободной цене
    // Summ Ц сумма сторно;
    // Department Ц секци€, в которую зарегистрирована операци€
    // 3
    // јннулирование по свободной цене.
    // Summ Ц сумма аннулированни€
    // 4
    // ¬озврат по свободной цене.
    // Summ Ц сумма возврата
    // 5
    // јбсолютна€ скидка на операцию.
    // Summ Ц сумма скидки
    // 6
    // јбсолютна€ надбавка на операцию.
    // Summ Ц сумма надбавки
    // 7
    // ѕроцентна€ скидка на операцию.
    // Percents Ц размер скидки в процентах
    // 8
    // ѕроцентна€ надбавка на операцию
    // Percents Ц размер надбавки в процентах
    // 11
    // ѕродажа по внутреннему коду товара.
    // PLUNumber Ц код товара;
    // Quantity Ц проданное количество
    // 12
    // —торно по внутреннему коду.
    // PLUNumber Ц код товара;
    // Quantity Ц сторнированное количество
    // 13
    // јннулирование по внутреннему коду.
    // PLUNumber Ц код товара;
    // Quantity Ц аннулированное количество
    // 14
    // ¬озврат по внутреннему коду.
    // PLUNumber Ц код товара;
    // Quantity Ц возвращенное количество
    // 21
    // ѕродажа по внешнему коду товара.
    // Summ Ц сумма продажи;
    // Department Ц секци€, в которую зарегистрирована операци€
    // 22
    // —торно по внешнему коду товара.
    // Summ Ц сумма продажи;
    // Department Ц секци€, в которую зарегистрирована операци€
    // 23
    // јннулирование по внешнему коду товара.
    // Summ Ц сумма аннулированни€
    // 24
    // ¬озврат по внешнему коду товара.
    // Summ Ц сумма возврата
    // 35
    // јбсолютна€ скидка на весь чек.
    // Summ Ц сумма скидки
    // 36
    // јбсолютна€ надбавка на весь чек.
    // Summ Ц сумма надбавки
    // 37
    // ѕроцентна€ скидка на весь чек.
    // Percents Ц размер скидки в процентах
    // 38
    // ѕроцентна€ надбавка на весь чек.
    // Percents Ц размер надбавки в процентах
    // 42
    // ќплата наличными
    // 44
    // ќплата типом 1 ( –≈ƒ»“ќћ)
    // 47
    // ќплата типом 2 (“ј–ќ…)
    // 48
    // ќплата типом 3 (ѕЋ.  ј–“ќ…)
    // 50
    // ¬несение денег в кассу.
    // Summ Ц внесенна€ сумма
    // 51
    // ¬ыплата денег из кассы.
    // Summ Ц выплаченна€ сумма
    //
    // 55
    //  онец чека.
    // Day, Month, Year, Hour, Minute Ц дата и врем€ закрыти€ чека;
    // Operator Ц номер кассира, закрывшего чек

    property ECRError: integer read GetECRError;
    //  од последней ошибки R
    property ECRErrorDescription: string read GetECRErrorDescription;
    // ќписание последней ошибки R
    property BatteryLow: boolean read GetBatteryLow;
    // ѕризнак разр€женности аккумул€тора   ћ R
    property BufferingMode: boolean read GetBufferingMode
      write SetBufferingMode;
    // ѕризнак нахождени€ в режиме буферизации документа RW
    property Value: integer read GetKKMValue write SetKKMValue;
    // «начени€ регистров 33-35 RW
    property DocNumber: integer read GetDocNumber;
    // Ќомер документа: 0 Е 99999999 R
    property Remainder: Double read GetRemainder;
    // ќстаток в чеке: 0.00 Е 99999999.99 R
    property Change: Double read GetChange;
    // —умма сдачи: 0.00 Е 99999999.99 R
    property MachineNumber: string read GetMachineNumber write SetMachineNumber;
    // –егистрационный номер машины: строка цифр длиной не более 10 символов RW
    property name:     string read GetName write Setname; // Ќазвание товара RW
    property Quantity: Double read GetQuantity write SetQuantity;
    //  оличество товара: 0.000 ... 9999999.999 RW
    property Price: Double read GetPrice write SetPrice;
    // ÷ена товара: 0.00 ... 99999999.99 RW
    property Department: integer read GetDepartment write SetDepartment;
    // —екци€ RW
    property AdvancedRegistration: boolean read GetAdvancedRegistration
      write SetAdvancedRegistration; // –асширенна€ регистраци€ RW
    property RecFont: integer read GetRecFont write SetRecFont;
    // Ўрифт на „Ћ: RW
    // 0 - настроенный в   ћ;
    // 1 - 8х6;
    // 2 - 7х6;
    // 3 - 6х6;
    // 4 - 5х6
    property RecFontHeight: integer read GetRecFontHeight
      write SetRecFontHeight; // ¬ысота текста на „Ћ:
    // 0 - настроенна€ в   ћ;
    // 1 - раст€нутый по высоте шрифт;
    // 2 - не используетс€;
    // 3 - шрифт единичной высоты
    property RecBrightness: integer read GetRecBrightness
      write SetRecBrightness; // яркость текста на „Ћ: 0 Е 15 RW
    property RecLineSpacing: integer read GetRecLineSpacing
      write SetRecLineSpacing;
    // ћежстрочный интервал на „Ћ: -19 ... 255 RW
    property JrnFont: integer read GetJrnFont write SetJrnFont;
    // Ўрифт на  Ћ:  RW
    // 0 - настроенный в   ћ;
    // 1 - 8х6;
    // 2 - 7х6;
    // 3 - 6х6;
    // 4 - 5х6
    property JrnFontHeight: integer read GetJrnFontHeight
      write SetJrnFontHeight; // ¬ысота текста на  Ћ: RW
    // 0 - настроенна€ в   ћ;
    // 1 - раст€нутый по высоте шрифт;
    // 2 - не используетс€;
    // 3 - шрифт единичной высоты
    property JrnBrightness: integer read GetJrnBrightness
      write SetJrnBrightness; // яркость текста на  Ћ: 0 Е 15 RW
    property JrnLineSpacing: integer read GetJrnLineSpacing
      write SetJrnLineSpacing;
    // ћежстрочный интервал на  Ћ: -19 ... 255 RW
    property DiscountType: integer read GetDiscountType write SetDiscountType;
    // “ип примен€емой скидки (надбавки) 0 Ч денежна€ скидка(надбавка); 1 Ч процентна€ скидка(надбавка). RW
    property DiscountValue: Double read GetDiscountValue write SetDiscountValue;
    // –азмер примен€емой скидки (надбавки) RW
    property ResultCode:        integer read GetResultCode; // –езультат R
    property ResultDescription: string read GetResultDescription;
    // —ообщение результата R
    property BadParam: integer read GetBadParam;
    // ќшибка параметра R
    property BadParamDescription: string read GetBadParamDescription;
    // —ообщение ошибки параметра R
    // property TestMode: boolean read GetTestMode write SetTestMode;
    // “естовый режим RW
    property PointPosition: word read GetKKMPointPosition
      write SetKKMPointPosition;
    // ѕоложение дес€тичной точки 0..3 RW
    property ModelCheck: boolean read GetModelCheck write SetModelCheck;
    // ѕровер€ть модель   ћ RW
    property CharLineLength: integer read GetCharLineLength;
    // ƒлина строки символов на текущей станции R
    property PixelLineLength: integer read GetPixelLineLength;
    // ƒлина строки в точках на текущей станции R
    property RcpCharLineLength: integer read GetRcpCharLineLength;
    // ƒлина строки символов на „Ћ: в зависимости от модели   ћ R
    property RcpPixelLineLength: integer read GetRcpPixelLineLength;
    // ƒлина строки в точках на „Ћ: в зависимости от модели   ћ R
    property JrnCharLineLength: integer read GetJrnCharLineLength;
    // ƒлина строки символов на  Ћ: в зависимости от модели   ћ R
    property JrnPixelLineLength: integer read GetJrnPixelLineLength;
    // ƒлина строки в точках на  Ћ: в зависимости от модели   ћ R
    property SlipCharLineLength: integer read GetSlipCharLineLength;
    // ƒлина строки символов на ѕƒ: в зависимости от модели   ћ R
    property SlipPixelLineLength: integer read GetSlipPixelLineLength;
    // ƒлина строки в точках на ѕƒ: в зависимости от модели   ћ R
    property SlipDocCharLineLength: integer read GetSlipDocCharLineLength;
    // Ўирина подкладного документа, в символах: 0Е99 RW
    property SlipDocTopMargin: integer read GetSlipDocTopMargin
      write SetSlipDocTopMargin;
    // ¬ерхний отступ подкладного документа: 0Е99 RW
    property SlipDocLeftMargin: integer read GetSlipDocLeftMargin
      write SetSlipDocLeftMargin;
    // Ћевый отступ подкладного документа: 0Е99 RW
    property SlipDocOrientation: integer read GetSlipDocOrientation
      write SetSlipDocOrientation;
    // ќриентаци€ подкладного документа: RW
    // 0 Ц нормальна€;
    // 1 Ц повернута€ на 180
    property Version: string read GetVersion;
    // ¬ерси€ драйвера R
    property ServerVersion: string read GetServerVersion;
    // ¬ерси€ сервера R
    property ApplicationHandle: THandle read GetApplicationHandle
      write SetApplicationHandle;
    // ƒескриптор главного окна клиентского приложени€ RW
    property DeviceDescription: string read GetDeviceDescription;
    // Ќазвание драйвера R
    property IsDemo: boolean read GetIsDemo;
    // ‘лаг работы в демонстрационном режиме R
    property CurrentDeviceIndex: integer read GetCurrentDeviceIndex
      write SetCurrentDeviceIndex; // »ндекс текущего Ћ”: 0 Е 98 RW
    property CurrentDeviceNumber: integer read GetCurrentDeviceNumber
      write SetCurrentDeviceNumber; // Ќомер текущего Ћ”: 1 Е 99 RW
    property DeviceEnabled: boolean read GetDeviceEnabled
      write SetDeviceEnabled; // ‘лаг Ђ”стройство включеної RW
    property MachineName: string read GetMachineName write SetMachineName;
    // »м€ ѕ  в сети RW
    property PortNumber: integer read GetPortNumber write SetPortNumber;
    // Ќомер порта ѕ : 1001 Ц COM1 Е 1256 Ц COM256 RW
    property BaudRate: integer read GetBaudRate write SetBaudRate;
    // —корость обмена с ѕ : RW
    // 3 Ц 1200;
    // 4 Ц 2400;
    // 5 Ц 4800;
    // 7 Ц 9600;
    // 9 Ц 14400;
    // 10 Ц 19200;
    // 12 Ц 38400;
    // 14 Ц 57600;
    // 18 Ц 115200
    property Model: integer read GetModel write SetModel; // ћодель   ћ RW
    property AccessPassword: string read GetAccessPassword
      write SetAccessPassword;
    // ѕароль доступа к   ћ: строка цифр длиной не более 8 RW
    property UseAccessPassword: boolean read GetUseAccessPassword
      write SetUseAccessPassword;
    // »спользовать пароль доступа к   ћ RW
    property DefaultPassword: string read GetDefaultPassword
      write SetDefaultPassword;
    // ѕароль оператора   ћ, используемый по умолчанию RW
    property WriteLogFile: word read GetWriteLogFile write SetWriteLogFile;
    // –асширенный журнал: RW
    // 0 Ц в журнал попадает только базова€ информаци€;
    // 1 Ц добавл€ет в журнал дополнительные сведени€ о работе протокола нижнего уровн€
    property DevicesSettings: string read GetDevicesSettings
      write SetDevicesSettings;
    // ѕараметры логических устройств в виде строки RW
    property DeviceSettings: string read GetDeviceSettings
      write SetDeviceSettings;
    // ѕараметры логического устройства в виде строки RW
    property CurrentDeviceName: string read GetCurrentDeviceName
      write SetCurrentDeviceName; // Ќазвание Ћ” RW
    property DeviceCount: integer read GetDeviceCount;
    //  оличество Ћ”: 1 Е 99 R
  end;

implementation

{ TKKMDriver }

function TKKMDriver.AddField: integer;
begin
  Result := FDevice.AddField;
end;

function TKKMDriver.AdvancedDisplayWrite: integer;
begin
  Result := FDevice.AdvancedDisplayWrite;
end;

function TKKMDriver.AdvancedOpenDrawer: integer;
begin
  Result := FDevice.AdvancedOpenDrawer;
end;

function TKKMDriver.Annulate: integer;
begin
  Result := FDevice.Annulate;
end;

function TKKMDriver.Beep: integer;
begin
  Result := FDevice.Beep;
end;

function TKKMDriver.BeginDocument: integer;
begin
  Result := FDevice.BeginDocument;
end;

function TKKMDriver.BeginFiscDocument: integer;
begin
  Result := FDevice.BeginFiscDocument;
end;

function TKKMDriver.Buy: integer;
begin
  Result := FDevice.Buy;
end;

function TKKMDriver.BuyAnnulate: integer;
begin
  Result := FDevice.BuyAnnulate;
end;

function TKKMDriver.BuyReturn: integer;
begin
  Result := FDevice.BuyReturn;
end;

function TKKMDriver.CancelCheck: integer;
begin
  Result := FDevice.CancelCheck;
end;

function TKKMDriver.CashIncome: integer;
begin
  Result := FDevice.CashIncome;
end;

function TKKMDriver.CashOutcome: integer;
begin
  Result := FDevice.CashOutcome;
end;

function TKKMDriver.ClearOutput: integer;
begin
  Result := FDevice.ClearOutput;
end;

function TKKMDriver.CloseCheck: integer;
begin
  Result := FDevice.CloseCheck;
end;

constructor TKKMDriver.Create;
begin
  CoInitialize(nil);
  inherited Create;
  if VarIsEmpty(FDevice) then
    try
      FDevice := CreateOLEObject('AddIn.FprnM45');
      FDevice.ENQTimeout := 60000; // “аймаут ожидани€ ответа драйвера 60сек
    except
      on E: exception do
        raise exception.Create(E.Message);
    end;
end;

function TKKMDriver.Delivery: integer;
begin
  Result := FDevice.Delivery;
end;

destructor TKKMDriver.Destroy;
begin
  if not VarIsEmpty(FDevice) then
    FDevice := 0;
  inherited Destroy;
  CoUninitialize;
end;

function TKKMDriver.DeviceEnableEx: integer;
begin
  Result := FDevice.DeviceEnableEx;
end;

function TKKMDriver.DisplayDraw: integer;
begin
  Result := FDevice.DisplayDraw;
end;

function TKKMDriver.EKLZGetStatus: integer;
begin
  Result := FDevice.EKLZGetStatus;
end;

function TKKMDriver.EndDocument: integer;
begin
  Result := FDevice.EndDocument;
end;

function TKKMDriver.EndFiscDocument: integer;
begin
  Result := FDevice.EndFiscDocument;
end;

function TKKMDriver.FullCut: integer;
begin
  Result := FDevice.FullCut;
end;

function TKKMDriver.GetAccessPassword: string;
begin
  Result := FDevice.AccessPassword;
end;

function TKKMDriver.GetAdvancedMode: integer;
begin
  Result := FDevice.AdvancedMode;
end;

function TKKMDriver.GetAdvancedRegistration: boolean;
begin
  Result := FDevice.AdvancedRegistration;
end;

function TKKMDriver.GetAlignment: integer;
begin
  Result := FDevice.Alignment;
end;

function TKKMDriver.GetApplicationHandle: THandle;
begin
  Result := FDevice.ApplicationHandle;
end;

function TKKMDriver.GetAttrNumber: integer;
begin
  Result := FDevice.AttrNumber;
end;

function TKKMDriver.GetAttrValue: string;
begin
  Result := FDevice.AttrValue;
end;

function TKKMDriver.GetAutoSize: boolean;
begin
  Result := FDevice.AutoSize;
end;

function TKKMDriver.GetBadParam: integer;
begin
  Result := FDevice.BadParam;
end;

function TKKMDriver.GetBadParamDescription: string;
begin
  Result := FDevice.BadParamDescription;
end;

function TKKMDriver.GetBarcode: string;
begin
  Result := FDevice.Barcode;
end;

function TKKMDriver.GetBarcodeType: integer;
begin
  Result := FDevice.BarcodeType;
end;

function TKKMDriver.GetBatteryLow: boolean;
begin
  Result := FDevice.BatteryLow;
end;

function TKKMDriver.GetBaudRate: integer;
begin
  Result := FDevice.BaudRate;
end;

function TKKMDriver.GetBufferingMode: boolean;
begin
  Result := FDevice.BufferingMode;
end;

function TKKMDriver.GetCaption: integer;
begin
  Result := FDevice.GetCaption;
end;

function TKKMDriver.GetChange: Double;
begin
  Result := FDevice.Change;
end;

function TKKMDriver.GetCharLineLength: integer;
begin
  Result := FDevice.CharLineLength;
end;

function TKKMDriver.GetCheckNumber: integer;
begin
  Result := FDevice.CheckNumber;
end;

function TKKMDriver.GetCheckPaperPresent: boolean;
begin
  Result := FDevice.CheckPaperPresent;
end;

function TKKMDriver.GetCheckState: TKKMCheckState;
begin
  Result := TKKMCheckState(FDevice.CheckState);
end;

function TKKMDriver.GetCheckType: TCheckType;
begin
  Result := TCheckType(FDevice.CheckType);
end;

function TKKMDriver.GetControlPaperPresent: boolean;
begin
  Result := FDevice.ControlPaperPresent;
end;

function TKKMDriver.GetCorrectionLevel: integer;
begin
  Result := FDevice.CorrectionLevel;
end;

function TKKMDriver.GetCount: integer;
begin
  Result := FDevice.Count;
end;

function TKKMDriver.GetCounterType: integer;
begin
  Result := FDevice.CounterType;
end;

function TKKMDriver.GetCoverOpened: boolean;
begin
  Result := FDevice.CoverOpened;
end;

function TKKMDriver.GetCurrentDeviceIndex: integer;
begin
  Result := FDevice.CurrentDeviceIndex;
end;

function TKKMDriver.GetCurrentDeviceName: string;
begin
  Result := FDevice.CurrentDeviceName;
end;

function TKKMDriver.GetCurrentDeviceNumber: integer;
begin
  Result := FDevice.CurrentDeviceNumber;
end;

function TKKMDriver.GetCurrentMode: integer;
begin
  Result := FDevice.GetCurrentMode;
end;

function TKKMDriver.GetDay: word;
begin
  Result := FDevice.Day;
end;

function TKKMDriver.GetDefaultPassword: string;
begin
  Result := FDevice.DefaultPassword;
end;

function TKKMDriver.GetDepartment: integer;
begin
  Result := FDevice.Department;
end;

function TKKMDriver.GetDestination: integer;
begin
  Result := FDevice.Destination;
end;

function TKKMDriver.GetDeviceCount: integer;
begin
  Result := FDevice.DeviceCount;
end;

function TKKMDriver.GetDeviceDescription: string;
begin
  Result := FDevice.DeviceDescription;
end;

function TKKMDriver.GetDeviceEnabled: boolean;
begin
  Result := FDevice.DeviceEnabled;
end;

function TKKMDriver.GetDeviceEnableTimeout: integer;
begin
  Result := FDevice.DeviceEnableTimeout;
end;

function TKKMDriver.GetDeviceMetrics: integer;
begin
  Result := FDevice.GetDeviceMetrics;
end;

function TKKMDriver.GetDeviceSettings: string;
begin
  Result := FDevice.DeviceSettings;
end;

function TKKMDriver.GetDevicesSettings: string;
begin
  Result := FDevice.DevicesSettings;
end;

function TKKMDriver.GetDisableParamWindow: boolean;
begin
  Result := FDevice.DisableParamWindow;
end;

function TKKMDriver.GetDisablePasswordSettings: boolean;
begin
  Result := FDevice.DisablePasswordSettings;
end;

function TKKMDriver.GetDiscountType: integer;
begin
  Result := FDevice.DiscountType;
end;

function TKKMDriver.GetDiscountTypeNumber: integer;
begin
  Result := FDevice.DiscountTypeNumber;
end;

function TKKMDriver.GetDiscountValue: Double;
begin
  Result := FDevice.DiscountValue;
end;

function TKKMDriver.GetDocNumber: integer;
begin
  Result := FDevice.DocNumber;
end;

function TKKMDriver.GetDrawerOffTimeout: integer;
begin
  Result := FDevice.DrawerOffTimeout;
end;

function TKKMDriver.GetDrawerOnQuantity: integer;
begin
  Result := FDevice.DrawerOnQuantity;
end;

function TKKMDriver.GetDrawerOnTimeout: integer;
begin
  Result := FDevice.DrawerOnTimeout;
end;

function TKKMDriver.GetDrawerOpened: boolean;
begin
  Result := FDevice.DrawerOpened;
end;

function TKKMDriver.GetDuration: integer;
begin
  Result := FDevice.Duration;
end;

function TKKMDriver.GetECRError: integer;
begin
  Result := FDevice.ECRError;
end;

function TKKMDriver.GetECRErrorDescription: string;
begin
  Result := FDevice.ECRErrorDescription;
end;

function TKKMDriver.GetEKLZFlags: integer;
begin
  Result := FDevice.EKLZFlags;
end;

function TKKMDriver.GetEnableCheckSumm: boolean;
begin
  Result := FDevice.EnableCheckSumm;
end;

function TKKMDriver.GetEndDay: word;
begin
  Result := FDevice.EndDay;
end;

function TKKMDriver.GetEndMonth: word;
begin
  Result := FDevice.EndMonth;
end;

function TKKMDriver.GetEndSession: integer;
begin
  Result := FDevice.EndSession;
end;

function TKKMDriver.GetEndYear: word;
begin
  Result := FDevice.EndYear;
end;

function TKKMDriver.GetEntryNum: integer;
begin
  Result := FDevice.EntryNum;
end;

function TKKMDriver.GetBarcodeColumns: integer;
begin
  Result := FDevice.BarcodeColumns;
end;

function TKKMDriver.GetBarcodeControlCode: boolean;
begin
  Result := FDevice.BarcodeControlCode;
end;

function TKKMDriver.GetBarcodeOptions: integer;
begin
  Result := FDevice.BarcodeOptions;
end;

function TKKMDriver.GetBarcodeRows: integer;
begin
  Result := FDevice.BarcodeRows;
end;

function TKKMDriver.GetFileName: string;
begin
  Result := FDevice.FileName;
end;

function TKKMDriver.GetFiscal: boolean;
begin
  Result := FDevice.Fiscal;
end;

function TKKMDriver.GetFontBold: boolean;
begin
  Result := FDevice.FontBold;
end;

function TKKMDriver.GetFontDblHeight: boolean;
begin
  Result := FDevice.FontDblHeight;
end;

function TKKMDriver.GetFontDblWidth: boolean;
begin
  Result := FDevice.FontDblWidth;
end;

function TKKMDriver.GetFontItalic: boolean;
begin
  Result := FDevice.FontItalic;
end;

function TKKMDriver.GetFontNegative: boolean;
begin
  Result := FDevice.FontNegative;
end;

function TKKMDriver.GetFontUnderline: boolean;
begin
  Result := FDevice.FontUnderline;
end;

function TKKMDriver.GetFrequency: integer;
begin
  Result := FDevice.Frequency;
end;

function TKKMDriver.GetFRLicense: integer;
begin
  Result := FDevice.License;
end;

function TKKMDriver.GetHeight: integer;
begin
  Result := FDevice.Height;
end;

function TKKMDriver.GetHour: word;
begin
  Result := FDevice.Hour;
end;

function TKKMDriver.GetInboundStream: string;
begin
  Result := FDevice.InboundStream;
end;

function TKKMDriver.GetINN: string;
begin
  Result := FDevice.INN;
end;

function TKKMDriver.GetIsDemo: boolean;
begin
  Result := FDevice.IsDemo;
end;

function TKKMDriver.GetJrnBrightness: integer;
begin
  Result := FDevice.JrnBrightness;
end;

function TKKMDriver.GetJrnCharLineLength: integer;
begin
  Result := FDevice.JrnCharLineLength;
end;

function TKKMDriver.GetJrnFont: integer;
begin
  Result := FDevice.JrnFont;
end;

function TKKMDriver.GetJrnFontHeight: integer;
begin
  Result := FDevice.JrnFontHeight;
end;

function TKKMDriver.GetJrnLineSpacing: integer;
begin
  Result := FDevice.JrnLineSpacing;
end;

function TKKMDriver.GetJrnPixelLineLength: integer;
begin
  Result := FDevice.JrnPixelLineLength;
end;

function TKKMDriver.GetKKMCaption: string;
begin
  Result := FDevice.Caption;
end;

function TKKMDriver.GetKKMCaptionPurpose: integer;
begin
  Result := FDevice.CaptionPurpose;
end;

function TKKMDriver.GetKKMMode: TKKMMode;
begin
  Result := TKKMMode(FDevice.Mode);
end;

function TKKMDriver.GetKKMPassword: string;
begin
  Result := FDevice.Password;
end;

function TKKMDriver.GetKKMSumm: Double;
begin
  Result := FDevice.Summ;
end;

function TKKMDriver.GetKKMValue: integer;
begin
  Result := FDevice.Value;
end;

function TKKMDriver.GetKKMValuePurpose: integer;
begin
  Result := FDevice.ValuePurpose;
end;

function TKKMDriver.GetLastError: integer;
begin
  Result := FDevice.GetLastError;
end;

function TKKMDriver.GetLastSummary: integer;
begin
  Result := FDevice.GetLastSummary;
end;

function TKKMDriver.GetLicense: integer;
begin
  Result := FDevice.GetLicense;
end;

function TKKMDriver.GetLineNumber: integer;
begin
  Result := FDevice.LineNumber;
end;

function TKKMDriver.GetLockDevices: boolean;
begin
  Result := FDevice.LockDevices;
end;

function TKKMDriver.GetMachineName: string;
begin
  Result := FDevice.MachineName;
end;

function TKKMDriver.GetMachineNumber: string;
begin
  Result := FDevice.MachineNumber;
end;

function TKKMDriver.GetMaxCaptionLength: integer;
begin
  Result := FDevice.MaxCaptionLength;
end;

function TKKMDriver.GetMinute: word;
begin
  Result := FDevice.Minute;
end;

function TKKMDriver.GetModel: integer;
begin
  Result := FDevice.Model;
end;

function TKKMDriver.GetModelCheck: boolean;
begin
  Result := FDevice.ModelCheck;
end;

function TKKMDriver.GetMonth: word;
begin
  Result := FDevice.Month;
end;

function TKKMDriver.GetName: string;
begin
  Result := FDevice.Name;
end;

function TKKMDriver.GetOperationType: integer;
begin
  Result := FDevice.OperationType;
end;

function TKKMDriver.GetOperatorName: string;
begin
  Result := FDevice.OperatorName;
end;

function TKKMDriver.GetOperatorNo: integer;
begin
  Result := FDevice.OperatorNo;
end;

function TKKMDriver.GetOperatorPassword: string;
begin
  Result := FDevice.OperatorPassword;
end;

function TKKMDriver.GetOutBoundStream: string;
begin
  Result := FDevice.OutboundStream;
end;

function TKKMDriver.GetOutOfPaper: boolean;
begin
  Result := FDevice.OutOfPaper;
end;

function TKKMDriver.GetPassword: integer;
begin
  Result := FDevice.GetPassword;
end;

function TKKMDriver.GetPasswordEntered: boolean;
begin
  Result := FDevice.PasswordEntered;
end;

function TKKMDriver.GetPercents: Double;
begin
  Result := FDevice.Percents;
end;

function TKKMDriver.GetPictureNumber: integer;
begin
  Result := FDevice.PictureNumber;
end;

function TKKMDriver.GetPictureState: integer;
begin
  Result := FDevice.PictureState;
end;

function TKKMDriver.GetPixelLineLength: integer;
begin
  Result := FDevice.PixelLineLength;
end;

function TKKMDriver.GetKKMPointPosition: word;
begin
  Result := FDevice.PointPosition;
end;

function TKKMDriver.GetPortNumber: integer;
begin
  Result := FDevice.PortNumber;
end;

function TKKMDriver.GetPrice: Double;
begin
  Result := FDevice.Price;
end;

function TKKMDriver.GetPrintBarcodeText: integer;
begin
  Result := FDevice.PrintBarcodeText;
end;

function TKKMDriver.GetPrinterConnectionFailed: boolean;
begin
  Result := FDevice.PrinterConnectionFailed;
end;

function TKKMDriver.GetPrinterCutMechanismError: boolean;
begin
  Result := FDevice.PrinterCutMechanismError;
end;

function TKKMDriver.GetPrinterMechanismError: boolean;
begin
  Result := FDevice.PrinterMechanismError;
end;

function TKKMDriver.GetPrinterOverheatError: boolean;
begin
  Result := FDevice.PrinterOverheatError;
end;

function TKKMDriver.GetPrintPurpose: integer;
begin
  Result := FDevice.PrintPurpose;
end;

function TKKMDriver.GetQuantity: Double;
begin
  Result := FDevice.Quantity;
end;

function TKKMDriver.GetRange: integer;
begin
  Result := FDevice.GetRange;
end;

function TKKMDriver.GetRcpCharLineLength: integer;
begin
  Result := FDevice.RcpCharLineLength;
end;

function TKKMDriver.GetRcpPixelLineLength: integer;
begin
  Result := FDevice.RcpPixelLineLength;
end;

function TKKMDriver.GetRecBrightness: integer;
begin
  Result := FDevice.RecBrightness;
end;

function TKKMDriver.GetRecFont: integer;
begin
  Result := FDevice.RecFont;
end;

function TKKMDriver.GetRecFontHeight: integer;
begin
  Result := FDevice.RecFontHeight;
end;

function TKKMDriver.GetRecLineSpacing: integer;
begin
  Result := FDevice.RecLineSpacing;
end;

function TKKMDriver.GetRegister: integer;
begin
  Result := FDevice.GetRegister;
end;

function TKKMDriver.GetRegisterNumber: integer;
begin
  Result := FDevice.RegisterNumber;
end;

function TKKMDriver.GetRemainder: Double;
begin
  Result := FDevice.Remainder;
end;

function TKKMDriver.GetReportType: TKKMReportType;
begin
  Result := TKKMReportType(FDevice.ReportType);
end;

function TKKMDriver.GetResultCode: integer;
begin
  Result := FDevice.ResultCode;
end;

function TKKMDriver.GetResultDescription: string;
begin
  Result := FDevice.ResultDescription;
end;

function TKKMDriver.GetROMVersion: string;
begin
  Result := FDevice.ROMVersion;
end;

function TKKMDriver.GetScale: Double;
begin
  Result := FDevice.Scale;
end;

function TKKMDriver.GetScaleVB: Double;
begin
  Result := FDevice.ScaleVB;
end;

function TKKMDriver.GetSecond: word;
begin
  Result := FDevice.Second;
end;

function TKKMDriver.GetSerialNumber: string;
begin
  Result := FDevice.SerialNumber;
end;

function TKKMDriver.GetServerVersion: string;
begin
  Result := FDevice.ServerVersion;
end;

function TKKMDriver.GetSession: integer;
begin
  Result := FDevice.Session;
end;

function TKKMDriver.GetSessionOpened: boolean;
begin
  Result := FDevice.SessionOpened;
end;

function TKKMDriver.GetSettings: integer;
begin
  Result := FDevice.GetSettings;
end;

function TKKMDriver.GetShowProgress: boolean;
begin
  Result := FDevice.ShowProgress;
end;

function TKKMDriver.GetSlipCharLineLength: integer;
begin
  Result := FDevice.SlipCharLineLength;
end;

function TKKMDriver.GetSlipDocCharLineLength: integer;
begin
  Result := FDevice.SlipDocCharLineLength;
end;

function TKKMDriver.GetSlipDocCopyCountHorz: integer;
begin
  Result := FDevice.SlipDocCopyCountHorz;
end;

function TKKMDriver.GetSlipDocCopyCountVert: integer;
begin
  Result := FDevice.SlipDocCopyCountVert;
end;

function TKKMDriver.GetSlipDocCopyShiftHorz: integer;
begin
  Result := SlipDocCopyShiftHorz;
end;

function TKKMDriver.GetSlipDocCopyShiftVert: integer;
begin
  Result := FDevice.SlipDocCopyShiftVert;
end;

function TKKMDriver.GetSlipDocLeftMargin: integer;
begin
  Result := FDevice.SlipDocLeftMargin;
end;

function TKKMDriver.GetSlipDocOrientation: integer;
begin
  Result := FDevice.SlipDocOrientation;
end;

function TKKMDriver.GetSlipDocTopMargin: integer;
begin
  Result := FDevice.SlipDocTopMargin;
end;

function TKKMDriver.GetSlipPixelLineLength: integer;
begin
  Result := FDevice.SlipPixelLineLength;
end;

function TKKMDriver.GetSlotNumber: integer;
begin
  Result := FDevice.SlotNumber;
end;

function TKKMDriver.GetStatus: integer;
begin
  Result := FDevice.GetStatus;
end;

function TKKMDriver.GetStatusPicture: integer;
begin
  Result := FDevice.GetSatusPicture;
end;

function TKKMDriver.GetStatusPictureArray: integer;
begin
  Result := FDevice.GetStatusPictureArray;
end;

function TKKMDriver.GetStreamFormat: integer;
begin
  Result := FDevice.StreamFormat;
end;

function TKKMDriver.GetSumm: integer;
begin
  Result := FDevice.GetSumm;
end;

function TKKMDriver.GetSupportedMode: integer;
begin
  Result := FDevice.GetSupportedMode;
end;

function TKKMDriver.GetTaxTypeNumber: integer;
begin
  Result := FDevice.TaxTypeNumber;
end;

// function TKKMDriver.GetTestMode: boolean;
// begin
// Result := FDevice.TestMode;
// end;

function TKKMDriver.GetTextWrap: integer;
begin
  Result := FDevice.TextWrap;
end;

function TKKMDriver.GetTransactionType: integer;
begin
  Result := FDevice.TransactionType;
end;

function TKKMDriver.GetTypeClose: TTypeClose;
begin
  Result := TTypeClose(FDevice.TypeClose);
end;

function TKKMDriver.GetUmode: TDeviceMode;
begin
  Result := TDeviceMode(FDevice.Umode);
end;

function TKKMDriver.GetUmodel: integer;
begin
  Result := FDevice.Umodel;
end;

function TKKMDriver.GetUnitVersion: integer;
begin
  Result := FDevice.GetUnitVersion;
end;

function TKKMDriver.GetUseAccessPassword: boolean;
begin
  Result := FDevice.UseAccessPassword;
end;

function TKKMDriver.GetValue: integer;
begin
  Result := FDevice.GetValue;
end;

function TKKMDriver.GetVersion: string;
begin
  Result := FDevice.Version;
end;

function TKKMDriver.GetWidth: integer;
begin
  Result := FDevice.Width;
end;

function TKKMDriver.GetWriteLogFile: word;
begin
  Result := FDevice.WriteLogFile;
end;

function TKKMDriver.GetYear: word;
begin
  Result := FDevice.Year;
end;

function TKKMDriver.LockKeyboard: integer;
begin
  Result := FDevice.LockKeyboard;
end;

function TKKMDriver.NewDocument: integer;
begin
  Result := FDevice.NewDocument;
end;

function TKKMDriver.OpenCheck: integer;
begin
  Result := FDevice.OpenCheck;
end;

function TKKMDriver.OpenDrawer: integer;
begin
  Result := FDevice.OpenDrawer;
end;

function TKKMDriver.OpenSession: integer;
begin
  Result := FDevice.OpenSession;
end;

function TKKMDriver.PartialCut: integer;
begin
  Result := FDevice.PartialCut;
end;

function TKKMDriver.Payment: integer;
begin
  Result := FDevice.Payment;
end;

function TKKMDriver.PercentsCharge: integer;
begin
  Result := FDevice.PercentCharge;
end;

function TKKMDriver.PercentsDiscount: integer;
begin
  Result := FDevice.PercentsDiscount;
end;

function TKKMDriver.PowerOff: integer;
begin
  Result := FDevice.PowerOff;
end;

function TKKMDriver.PrintBarcode: integer;
begin
  Result := FDevice.PrintBarcode;
end;

function TKKMDriver.PrintBitmap: integer;
begin
  Result := FDevice.PrintBitmap;
end;

function TKKMDriver.PrintBitmapFromFile: integer;
begin
  Result := FDevice.PrintBitmapFromFile;
end;

function TKKMDriver.PrintField: integer;
begin
  Result := FDevice.PrintField;
end;

function TKKMDriver.PrintFooter: integer;
begin
  Result := FDevice.PrintFooter;
end;

function TKKMDriver.PrintHeader: integer;
begin
  Result := FDevice.PrintHeader;
end;

function TKKMDriver.PrintPicture: integer;
begin
  Result := FDevice.PrintPicture;
end;

function TKKMDriver.PrintString: integer;
begin
  Result := FDevice.PrintString;
end;

function TKKMDriver.Registration: integer;
begin
  Result := FDevice.Registration;
end;

function TKKMDriver.Report: integer;
begin
  Result := FDevice.Report;
end;

function TKKMDriver.ResetChargeDiscount: integer;
begin
  Result := FDevice.ResetChargeDiscount;
end;

function TKKMDriver.ResetMode: integer;
begin
  Result := FDevice.ResetMode;
end;

function TKKMDriver.ResetTax: integer;
begin
  Result := FDevice.ResetTax;
end;

function TKKMDriver.Return: integer;
begin
  Result := FDevice.Return;
end;

function TKKMDriver.RunCommand: integer;
begin
  Result := FDevice.RunCommand;
end;

procedure TKKMDriver.SetAccessPassword(const Value: string);
begin
  FDevice.AccessPassword := Value;
end;

procedure TKKMDriver.SetAdvancedMode(const Value: integer);
begin
  FDevice.AdvancedMode := Value;
end;

procedure TKKMDriver.SetAdvancedRegistration(const Value: boolean);
begin
  FDevice.AdvancedRegistration := Value;
end;

procedure TKKMDriver.SetAlignment(const Value: integer);
begin
  FDevice.Alignment := Value;
end;

procedure TKKMDriver.SetApplicationHandle(const Value: THandle);
begin
  FDevice.ApplicationHandle := Value;
end;

procedure TKKMDriver.SetAttrNumber(const Value: integer);
begin
  FDevice.AttrNumber := Value;
end;

procedure TKKMDriver.SetAttrValue(const Value: string);
begin
  FDevice.AttrValue := Value;
end;

procedure TKKMDriver.SetAutoSize(const Value: boolean);
begin
  FDevice.AutoSize := Value;
end;

procedure TKKMDriver.SetBarcode(const Value: string);
begin
  FDevice.Barcode := Value;
end;

procedure TKKMDriver.SetBarcodeColumns(const Value: integer);
begin
  FDevice.BarcodeColumns := Value;
end;

procedure TKKMDriver.SetBarcodeControlCode(const Value: boolean);
begin
  FDevice.BarcodeControlCode := Value;
end;

procedure TKKMDriver.SetBarcodeOptions(const Value: integer);
begin
  FDevice.BarcodeOptions := Value;
end;

procedure TKKMDriver.SetBarcodeRows(const Value: integer);
begin
  FDevice.BarcodeRows := Value;
end;

procedure TKKMDriver.SetBarcodeType(const Value: integer);
begin
  FDevice.BarcodeType := Value;
end;

procedure TKKMDriver.SetBaudRate(const Value: integer);
begin
  FDevice.BaudRate := Value;
end;

procedure TKKMDriver.SetBufferingMode(const Value: boolean);
begin
  FDevice.BufferingMode := Value;
end;

function TKKMDriver.SetCaption: integer;
begin
  Result := FDevice.SetCaption;
end;

procedure TKKMDriver.SetCheckNumber(const Value: integer);
begin
  FDevice.CheckNumber := Value;
end;

procedure TKKMDriver.SetCheckType(const Value: TCheckType);
begin
  FDevice.CheckType := integer(Value);
end;

procedure TKKMDriver.SetCorrectionLevel(const Value: integer);
begin
  FDevice.CorrectionLevel := Value;
end;

procedure TKKMDriver.SetCount(const Value: integer);
begin
  FDevice.Count := Value;
end;

procedure TKKMDriver.SetCounterType(const Value: integer);
begin
  FDevice.CounterType := Value;
end;

procedure TKKMDriver.SetCurrentDeviceIndex(const Value: integer);
begin
  FDevice.CurrentDeviceIndex := Value;
end;

procedure TKKMDriver.SetCurrentDeviceName(const Value: string);
begin
  FDevice.CurrentDeviceName := Value;
end;

procedure TKKMDriver.SetCurrentDeviceNumber(const Value: integer);
begin
  FDevice.CurrentDeviceNumber := Value;
end;

function TKKMDriver.SetDate: integer;
begin
  Result := FDevice.SetDate;
end;

procedure TKKMDriver.SetDay(const Value: word);
begin
  FDevice.Day := Value;
end;

procedure TKKMDriver.SetDefaultPassword(const Value: string);
begin
  FDevice.DefaultPassword := Value;
end;

procedure TKKMDriver.SetDepartment(const Value: integer);
begin
  FDevice.Department := Value;
end;

procedure TKKMDriver.SetDestination(const Value: integer);
begin
  FDevice.Destination := Value;
end;

procedure TKKMDriver.SetDeviceEnabled(const Value: boolean);
begin
  FDevice.DeviceEnabled := Value;
end;

procedure TKKMDriver.SetDeviceEnableTimeout(const Value: integer);
begin
  FDevice.DeviceEnableTimeout := Value;
end;

procedure TKKMDriver.SetDeviceSettings(const Value: string);
begin
  FDevice.DeviceSettings := Value;
end;

procedure TKKMDriver.SetDevicesSettings(const Value: string);
begin
  FDevice.DevicesSettings := Value;
end;

procedure TKKMDriver.SetDisableParamWindow(const Value: boolean);
begin
  FDevice.DisableParamWindow := Value;
end;

procedure TKKMDriver.SetDisablePasswordSettings(const Value: boolean);
begin
  FDevice.DisablePasswordSettings := Value;
end;

procedure TKKMDriver.SetDiscountType(const Value: integer);
begin
  FDevice.DiscountType := Value;
end;

procedure TKKMDriver.SetDiscountTypeNumber(const Value: integer);
begin
  FDevice.DiscountTypeNumber := Value;
end;

procedure TKKMDriver.SetDiscountValue(const Value: Double);
begin
  FDevice.DiscountValue := Value;
end;

procedure TKKMDriver.SetDrawerOffTimeout(const Value: integer);
begin
  FDevice.DrawerOffTimeout := Value;
end;

procedure TKKMDriver.SetDrawerOnQuantity(const Value: integer);
begin
  FDevice.DrawerOnQuantity := Value;
end;

procedure TKKMDriver.SetDrawerOnTimeout(const Value: integer);
begin
  FDevice.DrawerOnTimeout := Value;
end;

procedure TKKMDriver.SetDuration(const Value: integer);
begin
  FDevice.Duration := Value;
end;

procedure TKKMDriver.SetEKLZFlags(const Value: integer);
begin
  FDevice.EKLZFlags := Value;
end;

procedure TKKMDriver.SetEnableCheckSumm(const Value: boolean);
begin
  FDevice.EnableCheckSumm := Value;
end;

procedure TKKMDriver.SetEndDay(const Value: word);
begin
  FDevice.EndDay := Value;
end;

procedure TKKMDriver.SetEndMonth(const Value: word);
begin
  FDevice.EndMonth := Value;
end;

procedure TKKMDriver.SetEndSession(const Value: integer);
begin
  FDevice.EndSession := Value;
end;

procedure TKKMDriver.SetEndYear(const Value: word);
begin
  FDevice.EndYear := Value;
end;

procedure TKKMDriver.SetEntryNum(const Value: integer);
begin
  FDevice.EntryNum := Value;
end;

procedure TKKMDriver.SetFileName(const Value: string);
begin
  FDevice.FileName := Value;
end;

procedure TKKMDriver.SetFontBold(const Value: boolean);
begin
  FDevice.FontBold := Value;
end;

procedure TKKMDriver.SetFontDblHeight(const Value: boolean);
begin
  FDevice.FontDblHeight := Value;
end;

procedure TKKMDriver.SetFontDblWidth(const Value: boolean);
begin
  FDevice.FontDblWidth := Value;
end;

procedure TKKMDriver.SetFontItalic(const Value: boolean);
begin
  FDevice.FontItalic := Value;
end;

procedure TKKMDriver.SetFontNegative(const Value: boolean);
begin
  FDevice.FontNegative := Value;
end;

procedure TKKMDriver.SetFontUnderline(const Value: boolean);
begin
  FDevice.FontUnderline := Value;
end;

procedure TKKMDriver.SetFrequency(const Value: integer);
begin
  FDevice.Frequency := Value;
end;

procedure TKKMDriver.SetFRLicense(const Value: integer);
begin
  FDevice.License := Value;
end;

procedure TKKMDriver.SetHeight(const Value: integer);
begin
  FDevice.Height := Value;
end;

procedure TKKMDriver.SetHour(const Value: word);
begin
  FDevice.Hour := Value;
end;

procedure TKKMDriver.SetInboundStream(const Value: string);
begin
  FDevice.InboundStream := Value;
end;

procedure TKKMDriver.SetJrnBrightness(const Value: integer);
begin
  FDevice.JrnBrightness := Value;
end;

procedure TKKMDriver.SetJrnFont(const Value: integer);
begin
  FDevice.JrnFont := Value;
end;

procedure TKKMDriver.SetJrnFontHeight(const Value: integer);
begin
  FDevice.JrnFontHeight := Value;
end;

procedure TKKMDriver.SetJrnLineSpacing(const Value: integer);
begin
  FDevice.JrnLineSpacing := Value;
end;

procedure TKKMDriver.SetKKMCaption(Value: string);
begin
  FDevice.Caption := Value;
end;

procedure TKKMDriver.SetKKMCaptionPurpose(const Value: integer);
begin
  FDevice.CaptionPurpose := Value;
end;

procedure TKKMDriver.SetKKMMode(Value: TKKMMode);
begin
  FDevice.Mode := integer(Value);
end;

procedure TKKMDriver.SetKKMPassword(Value: string);
begin
  FDevice.Password := Value;
end;

procedure TKKMDriver.SetKKMPointPosition(Value: word);
begin
  FDevice.PointPosition := Value;
end;

procedure TKKMDriver.SetKKMSumm(const Value: Double);
begin
  FDevice.Summ := Value;
end;

procedure TKKMDriver.SetKKMValue(Value: integer);
begin
  FDevice.Value := Value;
end;

procedure TKKMDriver.SetKKMValuePurpose(const Value: integer);
begin
  FDevice.ValuePurpose := Value;
end;

function TKKMDriver.SetLicense: integer;
begin
  Result := FDevice.SetLicense;
end;

procedure TKKMDriver.SetLineNumber(const Value: integer);
begin
  FDevice.LineNumber := Value;
end;

procedure TKKMDriver.SetLockDevices(const Value: boolean);
begin
  FDevice.LockDevices := Value;
end;

procedure TKKMDriver.SetMachineName(const Value: string);
begin
  FDevice.MachineName := Value;
end;

procedure TKKMDriver.SetMachineNumber(const Value: string);
begin
  FDevice.MachineNumber := Value;
end;

procedure TKKMDriver.SetMaxCaptionLength(const Value: integer);
begin
  FDevice.MaxCaptionLength := Value;
end;

procedure TKKMDriver.SetMinute(const Value: word);
begin
  FDevice.Minute := Value;
end;

function TKKMDriver.SetMode: integer;
begin
  Result := FDevice.SetMode;
end;

procedure TKKMDriver.SetModel(const Value: integer);
begin
  FDevice.Model := Value;
end;

procedure TKKMDriver.SetModelCheck(const Value: boolean);
begin
  FDevice.ModelCheck := Value;
end;

procedure TKKMDriver.SetMonth(const Value: word);
begin
  FDevice.Month := Value;
end;

procedure TKKMDriver.Setname(const Value: string);
begin
  FDevice.Name := Value;
end;

procedure TKKMDriver.SetOperationType(const Value: integer);
begin
  FDevice.OperationType := Value;
end;

procedure TKKMDriver.SetOperatorName(const Value: string);
begin
  FDevice.OperatorName := Value;
end;

procedure TKKMDriver.SetOperatorNo(const Value: integer);
begin
  FDevice.OperatorNo := Value;
end;

procedure TKKMDriver.SetOperatorPassword(const Value: string);
begin
  FDevice.OperatorPassword := Value;
end;

procedure TKKMDriver.SetOutBoundStream(const Value: string);
begin
  FDevice.OutboundStream := Value;
end;

function TKKMDriver.SetPassword: integer;
begin
  Result := FDevice.SetPassword;
end;

procedure TKKMDriver.SetPercents(const Value: Double);
begin
  FDevice.Percents := Value;
end;

procedure TKKMDriver.SetPictureNumber(const Value: integer);
begin
  FDevice.PictureNumber := Value;
end;

function TKKMDriver.SetPointPosition: integer;
begin
  Result := FDevice.SetPointPosition;
end;

procedure TKKMDriver.SetPortNumber(const Value: integer);
begin
  FDevice.PortNumber := Value;
end;

procedure TKKMDriver.SetPrice(const Value: Double);
begin
  FDevice.Price := Value;
end;

procedure TKKMDriver.SetPrintBarcodeText(const Value: integer);
begin
  FDevice.PrintBarcodeText := Value;
end;

procedure TKKMDriver.SetPrintPurpose(const Value: integer);
begin
  FDevice.PrintPurpose := Value;
end;

procedure TKKMDriver.SetQuantity(const Value: Double);
begin
  FDevice.Quantity := Value;
end;

procedure TKKMDriver.SetRecBrightness(const Value: integer);
begin
  FDevice.RecBrightness := Value;
end;

procedure TKKMDriver.SetRecFont(const Value: integer);
begin
  FDevice.RecFont := Value;
end;

procedure TKKMDriver.SetRecFontHeight(const Value: integer);
begin
  FDevice.RecFontHeight := Value;
end;

procedure TKKMDriver.SetRecLineSpacing(const Value: integer);
begin
  FDevice.RecLineSpacing := Value;
end;

procedure TKKMDriver.SetRegisterNumber(const Value: integer);
begin
  FDevice.RegisterNumber := Value;
end;

procedure TKKMDriver.SetReportType(const Value: TKKMReportType);
begin
  FDevice.ReportType := integer(Value);
end;

procedure TKKMDriver.SetScale(const Value: Double);
begin
  FDevice.Scale := Value;
end;

procedure TKKMDriver.SetScaleVB(const Value: Double);
begin
  FDevice.ScaleVB := Value;
end;

procedure TKKMDriver.SetSecond(const Value: word);
begin
  FDevice.Second := Value;
end;

procedure TKKMDriver.SetSession(const Value: integer);
begin
  FDevice.Session := Value;
end;

function TKKMDriver.SetSettings: integer;
begin
  Result := FDevice.SetSettings;
end;

procedure TKKMDriver.SetShowProgress(const Value: boolean);
begin
  FDevice.ShowProgress := Value;
end;

procedure TKKMDriver.SetSlipDocCopyCountHorz(const Value: integer);
begin
  FDevice.SlipDocCopyCountHorz := Value;
end;

procedure TKKMDriver.SetSlipDocCopyCountVert(const Value: integer);
begin
  FDevice.SlipDocCopyCountVert := Value;
end;

procedure TKKMDriver.SetSlipDocCopyShiftHorz(const Value: integer);
begin
  FDevice.SlipDocCopyShiftHorz := Value;
end;

procedure TKKMDriver.SetSlipDocCopyShiftVert(const Value: integer);
begin
  FDevice.SlipDocCopyShiftVert := Value;
end;

procedure TKKMDriver.SetSlipDocLeftMargin(const Value: integer);
begin
  FDevice.SlipDocLeftMargin := Value;
end;

procedure TKKMDriver.SetSlipDocOrientation(const Value: integer);
begin
  FDevice.SlipDocOrientation := Value;
end;

procedure TKKMDriver.SetSlipDocTopMargin(const Value: integer);
begin
  FDevice.SlipDocTopMargin := Value;
end;

procedure TKKMDriver.SetSlotNumber(const Value: integer);
begin
  FDevice.SlotNumber := Value;
end;

procedure TKKMDriver.SetStreamFormat(const Value: integer);
begin
  FDevice.StreamFormat := Value;
end;

procedure TKKMDriver.SetTaxTypeNumber(const Value: integer);
begin
  FDevice.TaxTypeNumber := Value;
end;

// procedure TKKMDriver.SetTestMode(const Value: boolean);
// begin
// FDevice.TestMode := Value;
// end;

procedure TKKMDriver.SetTextWrap(const Value: integer);
begin
  FDevice.TextWrap := Value;
end;

function TKKMDriver.SetTime: integer;
begin
  Result := FDevice.SetTime;
end;

procedure TKKMDriver.SetTransactionType(const Value: integer);
begin
  FDevice.TransactionType := Value;
end;

procedure TKKMDriver.SetTypeClose(const Value: TTypeClose);
begin
  FDevice.TypeClose := integer(Value);
end;

procedure TKKMDriver.SetUmode(const Value: TDeviceMode);
begin
  FDevice.Umode := integer(Value);
end;

procedure TKKMDriver.SetUmodel(const Value: integer);
begin
  FDevice.Umodel := Value;
end;

procedure TKKMDriver.SetUseAccessPassword(const Value: boolean);
begin
  FDevice.UseAccessPassword := Value;
end;

function TKKMDriver.SetValue: integer;
begin
  Result := FDevice.SetValue;
end;

procedure TKKMDriver.SetWidth(const Value: integer);
begin
  FDevice.Width := Value;
end;

procedure TKKMDriver.SetWriteLogFile(const Value: word);
begin
  FDevice.WriteLogFile := Value;
end;

procedure TKKMDriver.SetYear(const Value: word);
begin
  FDevice.Year := Value;
end;

function TKKMDriver.ShowProperties: integer;
begin
  Result := FDevice.ShowProperties;
end;

function TKKMDriver.Sound: integer;
begin
  Result := FDevice.Sound;
end;

function TKKMDriver.Storno: integer;
begin
  Result := FDevice.Storno;
end;

function TKKMDriver.StornoPayment: integer;
begin
  Result := FDevice.StornoPayment;
end;

function TKKMDriver.SummCharge: integer;
begin
  Result := FDevice.SummCharge;
end;

function TKKMDriver.SummDiscount: integer;
begin
  Result := FDevice.SummDiscount;
end;

function TKKMDriver.SummTax: integer;
begin
  Result := FDevice.SummTax;
end;

function TKKMDriver.UnLockKeyboard: integer;
begin
  Result := FDevice.UnLockKeyboard;
end;

function TKKMDriver.WriteAttribute: integer;
begin
  Result := FDevice.WriteAttribute;
end;


end.